{"version":3,"file":"mtx-poll-babylon-js.js","mappings":"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","sources":["webpack://MetalitixLogger/webpack/universalModuleDefinition","webpack://MetalitixLogger/./src/lib/mtx-poll-base.ts","webpack://MetalitixLogger/./node_modules/platform/platform.js","webpack://MetalitixLogger/./src/services/index.ts","webpack://MetalitixLogger/./src/constants/index.ts","webpack://MetalitixLogger/./src/types/index.ts","webpack://MetalitixLogger/./src/utils/index.ts","webpack://MetalitixLogger/./src/lib/mtx-engagement-survey.ts","webpack://MetalitixLogger/./node_modules/three/src/math/MathUtils.js","webpack://MetalitixLogger/webpack/bootstrap","webpack://MetalitixLogger/webpack/runtime/compat get default export","webpack://MetalitixLogger/webpack/runtime/define property getters","webpack://MetalitixLogger/webpack/runtime/global","webpack://MetalitixLogger/webpack/runtime/hasOwnProperty shorthand","webpack://MetalitixLogger/webpack/runtime/make namespace object","webpack://MetalitixLogger/webpack/runtime/node module decorator","webpack://MetalitixLogger/./src/lib/mtx-poll-babylon-js.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"MetalitixLogger\"] = factory();\n\telse\n\t\troot[\"MetalitixLogger\"] = factory();\n})(self, () => {\nreturn ","import { generateUUID } from 'three/src/math/MathUtils';\nimport platform from 'platform';\nimport { sendXRAnalyticsData } from '../services';\nimport {\n  DEFAULT_INTERVAL_VALUE,\n  MAX_INTERVAL_VALUE,\n  MAXIMUM_BATCH_RECORDS_LENGTH,\n  MAXIMUM_BATCH_SENDING_INTERVAL,\n  MAXIMUM_SESSION_KEEPALIVE_TIME,\n  MIN_INTERVAL_VALUE,\n} from '../constants';\nimport { MetalitixLoggerOptions, SurveyTheme, XRAnalytics } from '../types';\nimport { deepEqual, deviceType } from '../utils';\nimport { addSurvey } from './mtx-engagement-survey';\n\nexport default abstract class MetalitixLoggerBase<T> {\n  private appKey: string;\n  private apiVersion: string;\n  private interval: number = DEFAULT_INTERVAL_VALUE;\n  protected sessionId: string | null;\n  private pollRecords: XRAnalytics.Record[];\n  private lastPollTimestamp: number;\n  private nextPoll: number;\n  private pollInProgress: boolean;\n  private previousCameraData: XRAnalytics.UserCamera | null;\n  private customData: { [key: string]: any } = {};\n  private userMeta: Partial<XRAnalytics.UserMetadata>;\n  private showSurveyAutomatically: boolean;\n  private surveyTheme?: SurveyTheme;\n  private autoSurveyShowInMs: number;\n  private surveyTimer: number;\n  private prevFPSTime: number;\n  private frames: number;\n  private currentFPS: number;\n  private loopFPSRequestId: number;\n  protected object3D: T | null = null;\n\n  constructor(appKey: string, options: MetalitixLoggerOptions = {}) {\n    const {\n      pollInterval = DEFAULT_INTERVAL_VALUE,\n      apiVersion = 'v2',\n      userMeta = {},\n      showSurvey = false,\n      surveyTheme,\n    } = options;\n    this.appKey = appKey;\n    this.apiVersion = apiVersion;\n    this.userMeta = userMeta;\n    this.setPollInterval(pollInterval);\n    this.sessionId = null;\n    this.previousCameraData = null;\n    this.pollRecords = [];\n    this.lastPollTimestamp = -1;\n    this.pollInProgress = false;\n    this.nextPoll = -1;\n    this.pollInProgress = false;\n    this.showSurveyAutomatically = showSurvey;\n    this.surveyTheme = surveyTheme;\n    /** Show survey automatically in range between 30 seconds and 3 minutes */\n    this.autoSurveyShowInMs = (30 + 150 * Math.random()) * 1000;\n    this.surveyTimer = -1;\n    this.prevFPSTime = Date.now();\n    this.frames = 0;\n    this.currentFPS = 0;\n    this.loopFPSRequestId = -1;\n  }\n\n  public setPollInterval = (pollInterval: number) => {\n    this.interval = Math.min(MAX_INTERVAL_VALUE, Math.max(MIN_INTERVAL_VALUE, pollInterval));\n  };\n\n  private updateFPS = () => {\n    this.frames++;\n\n    let time = Date.now();\n\n    if (time >= this.prevFPSTime + 1000) {\n      this.currentFPS = (this.frames * 1000) / (time - this.prevFPSTime);\n\n      this.prevFPSTime = time;\n      this.frames = 0;\n    }\n  };\n\n  private loopFPS = () => {\n    this.loopFPSRequestId = requestAnimationFrame(() => {\n      this.updateFPS();\n      this.loopFPS();\n    });\n  };\n\n  private stopFPSLoop = () => {\n    cancelAnimationFrame(this.loopFPSRequestId);\n  };\n\n  public setCustomField = (key: string, value: any) => {\n    this.customData[key] = value;\n  };\n\n  public removeCustomField = (key: string) => {\n    delete this.customData[key];\n  };\n\n  private getRecord = (\n    eventType: XRAnalytics.EventTypes,\n    sessionId: string,\n    { userEvent, userMeta, camera, data }: XRAnalytics.RecordDataFields,\n  ) => {\n    const resultData = Object.assign({}, this.customData, data);\n\n    const base: XRAnalytics.RecordBase = {\n      object: 'xr.analytics.record',\n      appkey: this.appKey,\n      apiver: this.apiVersion,\n      sessionId,\n      timestamp: Date.now(),\n      metrics: {\n        fps: Math.round(this.currentFPS),\n      },\n      data: resultData,\n      userMeta,\n    };\n\n    if (eventType === XRAnalytics.EventTypes.SessionStart) {\n      console.assert(camera !== undefined, '\"camera\" is required for session start!');\n      return Object.assign({}, base, { eventType, camera }) as XRAnalytics.SessionStartRecord;\n    }\n\n    if (eventType === XRAnalytics.EventTypes.SessionUpdate) {\n      return Object.assign({}, base, { eventType, camera }) as XRAnalytics.SessionUpdateRecord;\n    }\n\n    if (eventType === XRAnalytics.EventTypes.SessionEnd) {\n      return Object.assign({}, base, { eventType, camera }) as XRAnalytics.SessionEndRecord;\n    }\n\n    if (eventType === XRAnalytics.EventTypes.UserPosition) {\n      return Object.assign({}, base, { eventType }) as XRAnalytics.UserPositionRecord;\n    }\n\n    if (eventType === XRAnalytics.EventTypes.UserInteraction) {\n      console.assert(userEvent !== undefined, '\"userEvent\" is required for user interaction!');\n      return Object.assign({}, base, { eventType, userEvent }) as XRAnalytics.UserInteractionRecord;\n    }\n\n    throw new Error('Unknown eventType: ' + eventType);\n  };\n\n  private addRecord = (\n    eventType: XRAnalytics.EventTypes,\n    { userEvent, userMeta, camera, data }: XRAnalytics.RecordDataFields,\n  ) => {\n    if (this.sessionId === null) {\n      return;\n    }\n\n    const record = this.getRecord(eventType, this.sessionId, { userEvent, userMeta, camera, data });\n\n    this.pollRecords.push(record);\n  };\n\n  private sendPosition = async (sendAll = false) => {\n    this.pollInProgress = true;\n\n    try {\n      const items = this.pollRecords.slice(0, MAXIMUM_BATCH_RECORDS_LENGTH);\n\n      const batchRecordsData = {\n        object: 'xr.analytics.batch.records',\n        appkey: this.appKey,\n        apiver: this.apiVersion,\n        items,\n      };\n\n      await sendXRAnalyticsData(batchRecordsData);\n      this.pollRecords = this.pollRecords.slice(MAXIMUM_BATCH_RECORDS_LENGTH);\n\n      if (this.pollRecords.length > 0 && sendAll) {\n        await this.sendPosition(true);\n      }\n\n      this.lastPollTimestamp = Date.now();\n    } catch (error) {\n      console.log('Something went wrong', error);\n      this.forceStopLoop();\n    } finally {\n      this.pollInProgress = false;\n    }\n  };\n\n  protected abstract getPositionData: (object3D: T | null) => XRAnalytics.Data | undefined;\n  protected abstract getCameraData: (object3D: T | null) => XRAnalytics.UserCamera | undefined;\n\n  private getUserMeta = (): Partial<XRAnalytics.UserMetadata> => {\n    return Object.assign({}, this.userMeta, {\n      userAgent: window.navigator.userAgent,\n      pagePath: location.pathname,\n      pageQuery: location.search,\n      systemInfo: {\n        deviceName: platform.product,\n        deviceType: deviceType,\n        operatingSystemName: platform.os?.family,\n        operatingSystemVersion: platform.os?.version,\n      },\n    });\n  };\n\n  private addSessionStart = () => {\n    const data = this.getPositionData(this.object3D);\n    const camera = this.getCameraData(this.object3D);\n    const userMeta = this.getUserMeta();\n    this.previousCameraData = camera || null;\n\n    if (data === undefined) {\n      return;\n    }\n\n    this.addRecord(XRAnalytics.EventTypes.SessionStart, { data, camera, userMeta });\n  };\n  private addSessionEnd = () => {\n    const data = this.getPositionData(this.object3D);\n    const userMeta = this.getUserMeta();\n    let camera = this.getCameraData(this.object3D);\n\n    if (data === undefined) {\n      return;\n    }\n\n    if (deepEqual(camera, this.previousCameraData)) {\n      /** Don't send the camera object if it was not changed */\n      camera = undefined;\n    }\n\n    this.addRecord(XRAnalytics.EventTypes.SessionEnd, { data, userMeta, camera });\n  };\n  private addUserPosition = () => {\n    const data = this.getPositionData(this.object3D);\n    const userMeta = this.getUserMeta();\n\n    if (data === undefined) {\n      return;\n    }\n\n    this.addRecord(XRAnalytics.EventTypes.UserPosition, { data, userMeta });\n  };\n  private addSessionUpdate = (camera?: XRAnalytics.UserCamera) => {\n    const data = this.getPositionData(this.object3D);\n    const userMeta = this.getUserMeta();\n\n    if (data === undefined) {\n      return;\n    }\n\n    this.addRecord(XRAnalytics.EventTypes.SessionUpdate, { data, camera, userMeta });\n  };\n\n  private sddNextUserPositionAndUpdateCameraIfNeeded = () => {\n    const camera = this.getCameraData(this.object3D);\n\n    if (camera === undefined || deepEqual(camera, this.previousCameraData)) {\n      this.addUserPosition();\n    } else {\n      this.addSessionUpdate(camera);\n      this.previousCameraData = camera;\n    }\n  };\n\n  private sendPositionLoop = (start = false) => {\n    /** Don't push position twice on session start */\n    if (!start) {\n      this.sddNextUserPositionAndUpdateCameraIfNeeded();\n    }\n\n    if (\n      !this.pollInProgress &&\n      this.pollRecords.length > 0 &&\n      (this.pollRecords.length >= MAXIMUM_BATCH_RECORDS_LENGTH ||\n        Date.now() - this.lastPollTimestamp >= MAXIMUM_BATCH_SENDING_INTERVAL)\n    ) {\n      this.sendPosition();\n    }\n\n    /** Stop polling data if session was ended and there is nothing to send */\n    if (this.sessionId === null && this.pollRecords.length === 0) {\n      return;\n    }\n\n    this.nextPoll = window.setTimeout(() => this.sendPositionLoop(), this.interval);\n  };\n\n  private forceStopLoop = () => clearTimeout(this.nextPoll);\n\n  private clearSessionPollRecords = () => {\n    this.pollRecords = [];\n  };\n\n  private handleVisibilityChange = async () => {\n    /**\n     *  If user close or switch the browser tab - we need to pause the session\n     *  Then if user came back to the browser - we need to try to resume the session if it's possible or start new one\n     **/\n    return document.visibilityState === 'hidden' ? this.pauseSession() : await this.resumeSession();\n  };\n\n  public startSession = (object3D: T) => {\n    this.object3D = object3D;\n    const sessionId = generateUUID();\n    this.sessionId = sessionId;\n    this.addSessionStart();\n    this.sendPositionLoop(true);\n    document.addEventListener('visibilitychange', this.handleVisibilityChange);\n    this.loopFPS();\n\n    if (this.showSurveyAutomatically) {\n      this.surveyTimer = window.setTimeout(\n        () => addSurvey({ appkey: this.appKey, sessionId, theme: this.surveyTheme }),\n        this.autoSurveyShowInMs,\n      );\n    }\n  };\n\n  public pauseSession = () => {\n    /** If the session was paused we need to send all our data and stop collecting new items */\n    this.forceStopLoop();\n    return this.sendPosition(true);\n  };\n\n  public resumeSession = async () => {\n    if (this.lastPollTimestamp < 0 || Date.now() - this.lastPollTimestamp <= MAXIMUM_SESSION_KEEPALIVE_TIME) {\n      /** If the session was resumed on time - we need to continue collect current session data */\n      this.forceStopLoop(); // in case if session was not paused\n      this.sendPositionLoop();\n    } else if (this.object3D !== null) {\n      /** If the session was resumed when server already has closed the session - we need to start new session */\n      const object3D = this.object3D;\n      await this.endSession();\n      this.startSession(object3D);\n    }\n  };\n\n  public endSession = async () => {\n    if (this.sessionId === null) {\n      /** The session was already ended */\n      return;\n    }\n\n    this.addSessionEnd();\n    this.object3D = null;\n    this.sessionId = null;\n    this.previousCameraData = null;\n    this.forceStopLoop();\n    this.stopFPSLoop();\n    await this.sendPosition(true);\n    this.clearSessionPollRecords();\n    this.lastPollTimestamp = -1;\n    document.removeEventListener('visibilitychange', this.handleVisibilityChange);\n  };\n\n  public updateUserMeta = (userMeta: Partial<XRAnalytics.UserMetadata>) => {\n    if (userMeta === undefined) {\n      return;\n    }\n\n    this.userMeta = userMeta;\n\n    this.addSessionUpdate();\n  };\n\n  private sendUserEvent = (\n    eventName: string,\n    eventType: XRAnalytics.UserInteractionTypes | string,\n    target?: string | XRAnalytics.EventPoint | any,\n    points?: XRAnalytics.EventPoint[],\n    params?: object,\n  ) => {\n    const data = this.getPositionData(this.object3D);\n    const userEvent: XRAnalytics.UserEvent = {\n      object: 'user.event',\n      eventName,\n      eventType,\n      target,\n      points,\n      params,\n    };\n    const userMeta = this.getUserMeta();\n\n    if (data === undefined) {\n      return;\n    }\n\n    this.addRecord(XRAnalytics.EventTypes.UserInteraction, { data, userMeta, userEvent });\n  };\n\n  public logCustomEvent = (eventName: string, params: object) => {\n    this.sendUserEvent(eventName, 'custom', undefined, undefined, params);\n  };\n\n  public logKeyDownEvent = (x: number, y: number, params?: object) => {\n    this.sendUserEvent(\n      'key_down',\n      XRAnalytics.UserInteractionTypes.KeyDown,\n      {\n        state: XRAnalytics.PointStates.Pressed,\n        timestamp: Date.now(),\n        position: { x, y },\n      },\n      undefined,\n      params,\n    );\n  };\n\n  public logKeyPressEvent = (x: number, y: number, params?: object) => {\n    this.sendUserEvent(\n      'key_press',\n      XRAnalytics.UserInteractionTypes.KeyPress,\n      {\n        state: XRAnalytics.PointStates.Stationary,\n        timestamp: Date.now(),\n        position: { x, y },\n      },\n      undefined,\n      params,\n    );\n  };\n\n  public logKeyUpEvent = (x: number, y: number, params?: object) => {\n    this.sendUserEvent(\n      'key_up',\n      XRAnalytics.UserInteractionTypes.KeyUp,\n      {\n        state: XRAnalytics.PointStates.Released,\n        timestamp: Date.now(),\n        position: { x, y },\n      },\n      undefined,\n      params,\n    );\n  };\n\n  public logMouseEnterEvent = (x: number, y: number, params?: object) => {\n    this.sendUserEvent(\n      'mouse_enter',\n      XRAnalytics.UserInteractionTypes.MouseEnter,\n      {\n        state: XRAnalytics.PointStates.Stationary,\n        timestamp: Date.now(),\n        position: { x, y },\n      },\n      undefined,\n      params,\n    );\n  };\n\n  public logMouseLeaveEvent = (x: number, y: number, params?: object) => {\n    this.sendUserEvent(\n      'mouse_leave',\n      XRAnalytics.UserInteractionTypes.MouseLeave,\n      {\n        state: XRAnalytics.PointStates.Stationary,\n        timestamp: Date.now(),\n        position: { x, y },\n      },\n      undefined,\n      params,\n    );\n  };\n\n  public logMouseOverEvent = (x: number, y: number, params?: object) => {\n    this.sendUserEvent(\n      'mouse_over',\n      XRAnalytics.UserInteractionTypes.MouseOver,\n      {\n        state: XRAnalytics.PointStates.Stationary,\n        timestamp: Date.now(),\n        position: { x, y },\n      },\n      undefined,\n      params,\n    );\n  };\n\n  public logMouseOutEvent = (x: number, y: number, params?: object) => {\n    this.sendUserEvent(\n      'mouse_out',\n      XRAnalytics.UserInteractionTypes.MouseOut,\n      {\n        state: XRAnalytics.PointStates.Stationary,\n        timestamp: Date.now(),\n        position: { x, y },\n      },\n      undefined,\n      params,\n    );\n  };\n\n  public logMouseDownEvent = (x: number, y: number, params?: object) => {\n    this.sendUserEvent(\n      'mouse_down',\n      XRAnalytics.UserInteractionTypes.MouseDown,\n      {\n        state: XRAnalytics.PointStates.Pressed,\n        timestamp: Date.now(),\n        position: { x, y },\n      },\n      undefined,\n      params,\n    );\n  };\n\n  public logMouseUpEvent = (x: number, y: number, params?: object) => {\n    this.sendUserEvent(\n      'mouse_up',\n      XRAnalytics.UserInteractionTypes.MouseUp,\n      {\n        state: XRAnalytics.PointStates.Released,\n        timestamp: Date.now(),\n        position: { x, y },\n      },\n      undefined,\n      params,\n    );\n  };\n\n  public logMouseMoveEvent = (x: number, y: number, params?: object) => {\n    this.sendUserEvent(\n      'mouse_move',\n      XRAnalytics.UserInteractionTypes.MouseMove,\n      {\n        state: XRAnalytics.PointStates.Updated,\n        timestamp: Date.now(),\n        position: { x, y },\n      },\n      undefined,\n      params,\n    );\n  };\n\n  public logMousePressEvent = (x: number, y: number, params?: object) => {\n    this.sendUserEvent(\n      'mouse_press',\n      XRAnalytics.UserInteractionTypes.MousePress,\n      {\n        state: XRAnalytics.PointStates.Stationary,\n        timestamp: Date.now(),\n        position: { x, y },\n      },\n      undefined,\n      params,\n    );\n  };\n\n  public logTouchTapEvent = (x: number, y: number, params?: object) => {\n    this.sendUserEvent(\n      'touch_tap',\n      XRAnalytics.UserInteractionTypes.TouchTap,\n      {\n        state: XRAnalytics.PointStates.Stationary,\n        timestamp: Date.now(),\n        position: { x, y },\n      },\n      undefined,\n      params,\n    );\n  };\n\n  public logTouchStartEvent = (x: number, y: number, params?: object) => {\n    this.sendUserEvent(\n      'touch_start',\n      XRAnalytics.UserInteractionTypes.TouchStart,\n      {\n        state: XRAnalytics.PointStates.Pressed,\n        timestamp: Date.now(),\n        position: { x, y },\n      },\n      undefined,\n      params,\n    );\n  };\n\n  public logTouchMoveEvent = (x: number, y: number, params?: object) => {\n    this.sendUserEvent(\n      'touch_move',\n      XRAnalytics.UserInteractionTypes.TouchMove,\n      {\n        state: XRAnalytics.PointStates.Updated,\n        timestamp: Date.now(),\n        position: { x, y },\n      },\n      undefined,\n      params,\n    );\n  };\n\n  public logTouchEndEvent = (x: number, y: number, params?: object) => {\n    this.sendUserEvent(\n      'touch_end',\n      XRAnalytics.UserInteractionTypes.TouchEnd,\n      {\n        state: XRAnalytics.PointStates.Released,\n        timestamp: Date.now(),\n        position: { x, y },\n      },\n      undefined,\n      params,\n    );\n  };\n\n  public logZoomStartEvent = (x: number, y: number, params?: object) => {\n    this.sendUserEvent(\n      'zoom_start',\n      XRAnalytics.UserInteractionTypes.ZoomStart,\n      {\n        state: XRAnalytics.PointStates.Pressed,\n        timestamp: Date.now(),\n        position: { x, y },\n      },\n      undefined,\n      params,\n    );\n  };\n\n  public logZoomUpdateEvent = (x: number, y: number, params?: object) => {\n    this.sendUserEvent(\n      'zoom_update',\n      XRAnalytics.UserInteractionTypes.ZoomUpdate,\n      {\n        state: XRAnalytics.PointStates.Updated,\n        timestamp: Date.now(),\n        position: { x, y },\n      },\n      undefined,\n      params,\n    );\n  };\n\n  public logZoomEndEvent = (x: number, y: number, params?: object) => {\n    this.sendUserEvent(\n      'zoom_end',\n      XRAnalytics.UserInteractionTypes.ZoomEnd,\n      {\n        state: XRAnalytics.PointStates.Released,\n        timestamp: Date.now(),\n        position: { x, y },\n      },\n      undefined,\n      params,\n    );\n  };\n\n  public showSurvey = (surveyTheme?: SurveyTheme) => {\n    clearTimeout(this.surveyTimer);\n\n    if (this.sessionId === null) {\n      return;\n    }\n\n    addSurvey({ appkey: this.appKey, sessionId: this.sessionId, theme: surveyTheme ?? this.surveyTheme, force: true });\n  };\n}\n","/*!\n * Platform.js v1.3.6\n * Copyright 2014-2020 Benjamin Tan\n * Copyright 2011-2013 John-David Dalton\n * Available under MIT license\n */\n;(function() {\n  'use strict';\n\n  /** Used to determine if values are of the language type `Object`. */\n  var objectTypes = {\n    'function': true,\n    'object': true\n  };\n\n  /** Used as a reference to the global object. */\n  var root = (objectTypes[typeof window] && window) || this;\n\n  /** Backup possible global object. */\n  var oldRoot = root;\n\n  /** Detect free variable `exports`. */\n  var freeExports = objectTypes[typeof exports] && exports;\n\n  /** Detect free variable `module`. */\n  var freeModule = objectTypes[typeof module] && module && !module.nodeType && module;\n\n  /** Detect free variable `global` from Node.js or Browserified code and use it as `root`. */\n  var freeGlobal = freeExports && freeModule && typeof global == 'object' && global;\n  if (freeGlobal && (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal || freeGlobal.self === freeGlobal)) {\n    root = freeGlobal;\n  }\n\n  /**\n   * Used as the maximum length of an array-like object.\n   * See the [ES6 spec](http://people.mozilla.org/~jorendorff/es6-draft.html#sec-tolength)\n   * for more details.\n   */\n  var maxSafeInteger = Math.pow(2, 53) - 1;\n\n  /** Regular expression to detect Opera. */\n  var reOpera = /\\bOpera/;\n\n  /** Possible global object. */\n  var thisBinding = this;\n\n  /** Used for native method references. */\n  var objectProto = Object.prototype;\n\n  /** Used to check for own properties of an object. */\n  var hasOwnProperty = objectProto.hasOwnProperty;\n\n  /** Used to resolve the internal `[[Class]]` of values. */\n  var toString = objectProto.toString;\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * Capitalizes a string value.\n   *\n   * @private\n   * @param {string} string The string to capitalize.\n   * @returns {string} The capitalized string.\n   */\n  function capitalize(string) {\n    string = String(string);\n    return string.charAt(0).toUpperCase() + string.slice(1);\n  }\n\n  /**\n   * A utility function to clean up the OS name.\n   *\n   * @private\n   * @param {string} os The OS name to clean up.\n   * @param {string} [pattern] A `RegExp` pattern matching the OS name.\n   * @param {string} [label] A label for the OS.\n   */\n  function cleanupOS(os, pattern, label) {\n    // Platform tokens are defined at:\n    // http://msdn.microsoft.com/en-us/library/ms537503(VS.85).aspx\n    // http://web.archive.org/web/20081122053950/http://msdn.microsoft.com/en-us/library/ms537503(VS.85).aspx\n    var data = {\n      '10.0': '10',\n      '6.4':  '10 Technical Preview',\n      '6.3':  '8.1',\n      '6.2':  '8',\n      '6.1':  'Server 2008 R2 / 7',\n      '6.0':  'Server 2008 / Vista',\n      '5.2':  'Server 2003 / XP 64-bit',\n      '5.1':  'XP',\n      '5.01': '2000 SP1',\n      '5.0':  '2000',\n      '4.0':  'NT',\n      '4.90': 'ME'\n    };\n    // Detect Windows version from platform tokens.\n    if (pattern && label && /^Win/i.test(os) && !/^Windows Phone /i.test(os) &&\n        (data = data[/[\\d.]+$/.exec(os)])) {\n      os = 'Windows ' + data;\n    }\n    // Correct character case and cleanup string.\n    os = String(os);\n\n    if (pattern && label) {\n      os = os.replace(RegExp(pattern, 'i'), label);\n    }\n\n    os = format(\n      os.replace(/ ce$/i, ' CE')\n        .replace(/\\bhpw/i, 'web')\n        .replace(/\\bMacintosh\\b/, 'Mac OS')\n        .replace(/_PowerPC\\b/i, ' OS')\n        .replace(/\\b(OS X) [^ \\d]+/i, '$1')\n        .replace(/\\bMac (OS X)\\b/, '$1')\n        .replace(/\\/(\\d)/, ' $1')\n        .replace(/_/g, '.')\n        .replace(/(?: BePC|[ .]*fc[ \\d.]+)$/i, '')\n        .replace(/\\bx86\\.64\\b/gi, 'x86_64')\n        .replace(/\\b(Windows Phone) OS\\b/, '$1')\n        .replace(/\\b(Chrome OS \\w+) [\\d.]+\\b/, '$1')\n        .split(' on ')[0]\n    );\n\n    return os;\n  }\n\n  /**\n   * An iteration utility for arrays and objects.\n   *\n   * @private\n   * @param {Array|Object} object The object to iterate over.\n   * @param {Function} callback The function called per iteration.\n   */\n  function each(object, callback) {\n    var index = -1,\n        length = object ? object.length : 0;\n\n    if (typeof length == 'number' && length > -1 && length <= maxSafeInteger) {\n      while (++index < length) {\n        callback(object[index], index, object);\n      }\n    } else {\n      forOwn(object, callback);\n    }\n  }\n\n  /**\n   * Trim and conditionally capitalize string values.\n   *\n   * @private\n   * @param {string} string The string to format.\n   * @returns {string} The formatted string.\n   */\n  function format(string) {\n    string = trim(string);\n    return /^(?:webOS|i(?:OS|P))/.test(string)\n      ? string\n      : capitalize(string);\n  }\n\n  /**\n   * Iterates over an object's own properties, executing the `callback` for each.\n   *\n   * @private\n   * @param {Object} object The object to iterate over.\n   * @param {Function} callback The function executed per own property.\n   */\n  function forOwn(object, callback) {\n    for (var key in object) {\n      if (hasOwnProperty.call(object, key)) {\n        callback(object[key], key, object);\n      }\n    }\n  }\n\n  /**\n   * Gets the internal `[[Class]]` of a value.\n   *\n   * @private\n   * @param {*} value The value.\n   * @returns {string} The `[[Class]]`.\n   */\n  function getClassOf(value) {\n    return value == null\n      ? capitalize(value)\n      : toString.call(value).slice(8, -1);\n  }\n\n  /**\n   * Host objects can return type values that are different from their actual\n   * data type. The objects we are concerned with usually return non-primitive\n   * types of \"object\", \"function\", or \"unknown\".\n   *\n   * @private\n   * @param {*} object The owner of the property.\n   * @param {string} property The property to check.\n   * @returns {boolean} Returns `true` if the property value is a non-primitive, else `false`.\n   */\n  function isHostType(object, property) {\n    var type = object != null ? typeof object[property] : 'number';\n    return !/^(?:boolean|number|string|undefined)$/.test(type) &&\n      (type == 'object' ? !!object[property] : true);\n  }\n\n  /**\n   * Prepares a string for use in a `RegExp` by making hyphens and spaces optional.\n   *\n   * @private\n   * @param {string} string The string to qualify.\n   * @returns {string} The qualified string.\n   */\n  function qualify(string) {\n    return String(string).replace(/([ -])(?!$)/g, '$1?');\n  }\n\n  /**\n   * A bare-bones `Array#reduce` like utility function.\n   *\n   * @private\n   * @param {Array} array The array to iterate over.\n   * @param {Function} callback The function called per iteration.\n   * @returns {*} The accumulated result.\n   */\n  function reduce(array, callback) {\n    var accumulator = null;\n    each(array, function(value, index) {\n      accumulator = callback(accumulator, value, index, array);\n    });\n    return accumulator;\n  }\n\n  /**\n   * Removes leading and trailing whitespace from a string.\n   *\n   * @private\n   * @param {string} string The string to trim.\n   * @returns {string} The trimmed string.\n   */\n  function trim(string) {\n    return String(string).replace(/^ +| +$/g, '');\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * Creates a new platform object.\n   *\n   * @memberOf platform\n   * @param {Object|string} [ua=navigator.userAgent] The user agent string or\n   *  context object.\n   * @returns {Object} A platform object.\n   */\n  function parse(ua) {\n\n    /** The environment context object. */\n    var context = root;\n\n    /** Used to flag when a custom context is provided. */\n    var isCustomContext = ua && typeof ua == 'object' && getClassOf(ua) != 'String';\n\n    // Juggle arguments.\n    if (isCustomContext) {\n      context = ua;\n      ua = null;\n    }\n\n    /** Browser navigator object. */\n    var nav = context.navigator || {};\n\n    /** Browser user agent string. */\n    var userAgent = nav.userAgent || '';\n\n    ua || (ua = userAgent);\n\n    /** Used to flag when `thisBinding` is the [ModuleScope]. */\n    var isModuleScope = isCustomContext || thisBinding == oldRoot;\n\n    /** Used to detect if browser is like Chrome. */\n    var likeChrome = isCustomContext\n      ? !!nav.likeChrome\n      : /\\bChrome\\b/.test(ua) && !/internal|\\n/i.test(toString.toString());\n\n    /** Internal `[[Class]]` value shortcuts. */\n    var objectClass = 'Object',\n        airRuntimeClass = isCustomContext ? objectClass : 'ScriptBridgingProxyObject',\n        enviroClass = isCustomContext ? objectClass : 'Environment',\n        javaClass = (isCustomContext && context.java) ? 'JavaPackage' : getClassOf(context.java),\n        phantomClass = isCustomContext ? objectClass : 'RuntimeObject';\n\n    /** Detect Java environments. */\n    var java = /\\bJava/.test(javaClass) && context.java;\n\n    /** Detect Rhino. */\n    var rhino = java && getClassOf(context.environment) == enviroClass;\n\n    /** A character to represent alpha. */\n    var alpha = java ? 'a' : '\\u03b1';\n\n    /** A character to represent beta. */\n    var beta = java ? 'b' : '\\u03b2';\n\n    /** Browser document object. */\n    var doc = context.document || {};\n\n    /**\n     * Detect Opera browser (Presto-based).\n     * http://www.howtocreate.co.uk/operaStuff/operaObject.html\n     * http://dev.opera.com/articles/view/opera-mini-web-content-authoring-guidelines/#operamini\n     */\n    var opera = context.operamini || context.opera;\n\n    /** Opera `[[Class]]`. */\n    var operaClass = reOpera.test(operaClass = (isCustomContext && opera) ? opera['[[Class]]'] : getClassOf(opera))\n      ? operaClass\n      : (opera = null);\n\n    /*------------------------------------------------------------------------*/\n\n    /** Temporary variable used over the script's lifetime. */\n    var data;\n\n    /** The CPU architecture. */\n    var arch = ua;\n\n    /** Platform description array. */\n    var description = [];\n\n    /** Platform alpha/beta indicator. */\n    var prerelease = null;\n\n    /** A flag to indicate that environment features should be used to resolve the platform. */\n    var useFeatures = ua == userAgent;\n\n    /** The browser/environment version. */\n    var version = useFeatures && opera && typeof opera.version == 'function' && opera.version();\n\n    /** A flag to indicate if the OS ends with \"/ Version\" */\n    var isSpecialCasedOS;\n\n    /* Detectable layout engines (order is important). */\n    var layout = getLayout([\n      { 'label': 'EdgeHTML', 'pattern': 'Edge' },\n      'Trident',\n      { 'label': 'WebKit', 'pattern': 'AppleWebKit' },\n      'iCab',\n      'Presto',\n      'NetFront',\n      'Tasman',\n      'KHTML',\n      'Gecko'\n    ]);\n\n    /* Detectable browser names (order is important). */\n    var name = getName([\n      'Adobe AIR',\n      'Arora',\n      'Avant Browser',\n      'Breach',\n      'Camino',\n      'Electron',\n      'Epiphany',\n      'Fennec',\n      'Flock',\n      'Galeon',\n      'GreenBrowser',\n      'iCab',\n      'Iceweasel',\n      'K-Meleon',\n      'Konqueror',\n      'Lunascape',\n      'Maxthon',\n      { 'label': 'Microsoft Edge', 'pattern': '(?:Edge|Edg|EdgA|EdgiOS)' },\n      'Midori',\n      'Nook Browser',\n      'PaleMoon',\n      'PhantomJS',\n      'Raven',\n      'Rekonq',\n      'RockMelt',\n      { 'label': 'Samsung Internet', 'pattern': 'SamsungBrowser' },\n      'SeaMonkey',\n      { 'label': 'Silk', 'pattern': '(?:Cloud9|Silk-Accelerated)' },\n      'Sleipnir',\n      'SlimBrowser',\n      { 'label': 'SRWare Iron', 'pattern': 'Iron' },\n      'Sunrise',\n      'Swiftfox',\n      'Vivaldi',\n      'Waterfox',\n      'WebPositive',\n      { 'label': 'Yandex Browser', 'pattern': 'YaBrowser' },\n      { 'label': 'UC Browser', 'pattern': 'UCBrowser' },\n      'Opera Mini',\n      { 'label': 'Opera Mini', 'pattern': 'OPiOS' },\n      'Opera',\n      { 'label': 'Opera', 'pattern': 'OPR' },\n      'Chromium',\n      'Chrome',\n      { 'label': 'Chrome', 'pattern': '(?:HeadlessChrome)' },\n      { 'label': 'Chrome Mobile', 'pattern': '(?:CriOS|CrMo)' },\n      { 'label': 'Firefox', 'pattern': '(?:Firefox|Minefield)' },\n      { 'label': 'Firefox for iOS', 'pattern': 'FxiOS' },\n      { 'label': 'IE', 'pattern': 'IEMobile' },\n      { 'label': 'IE', 'pattern': 'MSIE' },\n      'Safari'\n    ]);\n\n    /* Detectable products (order is important). */\n    var product = getProduct([\n      { 'label': 'BlackBerry', 'pattern': 'BB10' },\n      'BlackBerry',\n      { 'label': 'Galaxy S', 'pattern': 'GT-I9000' },\n      { 'label': 'Galaxy S2', 'pattern': 'GT-I9100' },\n      { 'label': 'Galaxy S3', 'pattern': 'GT-I9300' },\n      { 'label': 'Galaxy S4', 'pattern': 'GT-I9500' },\n      { 'label': 'Galaxy S5', 'pattern': 'SM-G900' },\n      { 'label': 'Galaxy S6', 'pattern': 'SM-G920' },\n      { 'label': 'Galaxy S6 Edge', 'pattern': 'SM-G925' },\n      { 'label': 'Galaxy S7', 'pattern': 'SM-G930' },\n      { 'label': 'Galaxy S7 Edge', 'pattern': 'SM-G935' },\n      'Google TV',\n      'Lumia',\n      'iPad',\n      'iPod',\n      'iPhone',\n      'Kindle',\n      { 'label': 'Kindle Fire', 'pattern': '(?:Cloud9|Silk-Accelerated)' },\n      'Nexus',\n      'Nook',\n      'PlayBook',\n      'PlayStation Vita',\n      'PlayStation',\n      'TouchPad',\n      'Transformer',\n      { 'label': 'Wii U', 'pattern': 'WiiU' },\n      'Wii',\n      'Xbox One',\n      { 'label': 'Xbox 360', 'pattern': 'Xbox' },\n      'Xoom'\n    ]);\n\n    /* Detectable manufacturers. */\n    var manufacturer = getManufacturer({\n      'Apple': { 'iPad': 1, 'iPhone': 1, 'iPod': 1 },\n      'Alcatel': {},\n      'Archos': {},\n      'Amazon': { 'Kindle': 1, 'Kindle Fire': 1 },\n      'Asus': { 'Transformer': 1 },\n      'Barnes & Noble': { 'Nook': 1 },\n      'BlackBerry': { 'PlayBook': 1 },\n      'Google': { 'Google TV': 1, 'Nexus': 1 },\n      'HP': { 'TouchPad': 1 },\n      'HTC': {},\n      'Huawei': {},\n      'Lenovo': {},\n      'LG': {},\n      'Microsoft': { 'Xbox': 1, 'Xbox One': 1 },\n      'Motorola': { 'Xoom': 1 },\n      'Nintendo': { 'Wii U': 1,  'Wii': 1 },\n      'Nokia': { 'Lumia': 1 },\n      'Oppo': {},\n      'Samsung': { 'Galaxy S': 1, 'Galaxy S2': 1, 'Galaxy S3': 1, 'Galaxy S4': 1 },\n      'Sony': { 'PlayStation': 1, 'PlayStation Vita': 1 },\n      'Xiaomi': { 'Mi': 1, 'Redmi': 1 }\n    });\n\n    /* Detectable operating systems (order is important). */\n    var os = getOS([\n      'Windows Phone',\n      'KaiOS',\n      'Android',\n      'CentOS',\n      { 'label': 'Chrome OS', 'pattern': 'CrOS' },\n      'Debian',\n      { 'label': 'DragonFly BSD', 'pattern': 'DragonFly' },\n      'Fedora',\n      'FreeBSD',\n      'Gentoo',\n      'Haiku',\n      'Kubuntu',\n      'Linux Mint',\n      'OpenBSD',\n      'Red Hat',\n      'SuSE',\n      'Ubuntu',\n      'Xubuntu',\n      'Cygwin',\n      'Symbian OS',\n      'hpwOS',\n      'webOS ',\n      'webOS',\n      'Tablet OS',\n      'Tizen',\n      'Linux',\n      'Mac OS X',\n      'Macintosh',\n      'Mac',\n      'Windows 98;',\n      'Windows '\n    ]);\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Picks the layout engine from an array of guesses.\n     *\n     * @private\n     * @param {Array} guesses An array of guesses.\n     * @returns {null|string} The detected layout engine.\n     */\n    function getLayout(guesses) {\n      return reduce(guesses, function(result, guess) {\n        return result || RegExp('\\\\b' + (\n          guess.pattern || qualify(guess)\n        ) + '\\\\b', 'i').exec(ua) && (guess.label || guess);\n      });\n    }\n\n    /**\n     * Picks the manufacturer from an array of guesses.\n     *\n     * @private\n     * @param {Array} guesses An object of guesses.\n     * @returns {null|string} The detected manufacturer.\n     */\n    function getManufacturer(guesses) {\n      return reduce(guesses, function(result, value, key) {\n        // Lookup the manufacturer by product or scan the UA for the manufacturer.\n        return result || (\n          value[product] ||\n          value[/^[a-z]+(?: +[a-z]+\\b)*/i.exec(product)] ||\n          RegExp('\\\\b' + qualify(key) + '(?:\\\\b|\\\\w*\\\\d)', 'i').exec(ua)\n        ) && key;\n      });\n    }\n\n    /**\n     * Picks the browser name from an array of guesses.\n     *\n     * @private\n     * @param {Array} guesses An array of guesses.\n     * @returns {null|string} The detected browser name.\n     */\n    function getName(guesses) {\n      return reduce(guesses, function(result, guess) {\n        return result || RegExp('\\\\b' + (\n          guess.pattern || qualify(guess)\n        ) + '\\\\b', 'i').exec(ua) && (guess.label || guess);\n      });\n    }\n\n    /**\n     * Picks the OS name from an array of guesses.\n     *\n     * @private\n     * @param {Array} guesses An array of guesses.\n     * @returns {null|string} The detected OS name.\n     */\n    function getOS(guesses) {\n      return reduce(guesses, function(result, guess) {\n        var pattern = guess.pattern || qualify(guess);\n        if (!result && (result =\n              RegExp('\\\\b' + pattern + '(?:/[\\\\d.]+|[ \\\\w.]*)', 'i').exec(ua)\n            )) {\n          result = cleanupOS(result, pattern, guess.label || guess);\n        }\n        return result;\n      });\n    }\n\n    /**\n     * Picks the product name from an array of guesses.\n     *\n     * @private\n     * @param {Array} guesses An array of guesses.\n     * @returns {null|string} The detected product name.\n     */\n    function getProduct(guesses) {\n      return reduce(guesses, function(result, guess) {\n        var pattern = guess.pattern || qualify(guess);\n        if (!result && (result =\n              RegExp('\\\\b' + pattern + ' *\\\\d+[.\\\\w_]*', 'i').exec(ua) ||\n              RegExp('\\\\b' + pattern + ' *\\\\w+-[\\\\w]*', 'i').exec(ua) ||\n              RegExp('\\\\b' + pattern + '(?:; *(?:[a-z]+[_-])?[a-z]+\\\\d+|[^ ();-]*)', 'i').exec(ua)\n            )) {\n          // Split by forward slash and append product version if needed.\n          if ((result = String((guess.label && !RegExp(pattern, 'i').test(guess.label)) ? guess.label : result).split('/'))[1] && !/[\\d.]+/.test(result[0])) {\n            result[0] += ' ' + result[1];\n          }\n          // Correct character case and cleanup string.\n          guess = guess.label || guess;\n          result = format(result[0]\n            .replace(RegExp(pattern, 'i'), guess)\n            .replace(RegExp('; *(?:' + guess + '[_-])?', 'i'), ' ')\n            .replace(RegExp('(' + guess + ')[-_.]?(\\\\w)', 'i'), '$1 $2'));\n        }\n        return result;\n      });\n    }\n\n    /**\n     * Resolves the version using an array of UA patterns.\n     *\n     * @private\n     * @param {Array} patterns An array of UA patterns.\n     * @returns {null|string} The detected version.\n     */\n    function getVersion(patterns) {\n      return reduce(patterns, function(result, pattern) {\n        return result || (RegExp(pattern +\n          '(?:-[\\\\d.]+/|(?: for [\\\\w-]+)?[ /-])([\\\\d.]+[^ ();/_-]*)', 'i').exec(ua) || 0)[1] || null;\n      });\n    }\n\n    /**\n     * Returns `platform.description` when the platform object is coerced to a string.\n     *\n     * @name toString\n     * @memberOf platform\n     * @returns {string} Returns `platform.description` if available, else an empty string.\n     */\n    function toStringPlatform() {\n      return this.description || '';\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    // Convert layout to an array so we can add extra details.\n    layout && (layout = [layout]);\n\n    // Detect Android products.\n    // Browsers on Android devices typically provide their product IDS after \"Android;\"\n    // up to \"Build\" or \") AppleWebKit\".\n    // Example:\n    // \"Mozilla/5.0 (Linux; Android 8.1.0; Moto G (5) Plus) AppleWebKit/537.36\n    // (KHTML, like Gecko) Chrome/70.0.3538.80 Mobile Safari/537.36\"\n    if (/\\bAndroid\\b/.test(os) && !product &&\n        (data = /\\bAndroid[^;]*;(.*?)(?:Build|\\) AppleWebKit)\\b/i.exec(ua))) {\n      product = trim(data[1])\n        // Replace any language codes (eg. \"en-US\").\n        .replace(/^[a-z]{2}-[a-z]{2};\\s*/i, '')\n        || null;\n    }\n    // Detect product names that contain their manufacturer's name.\n    if (manufacturer && !product) {\n      product = getProduct([manufacturer]);\n    } else if (manufacturer && product) {\n      product = product\n        .replace(RegExp('^(' + qualify(manufacturer) + ')[-_.\\\\s]', 'i'), manufacturer + ' ')\n        .replace(RegExp('^(' + qualify(manufacturer) + ')[-_.]?(\\\\w)', 'i'), manufacturer + ' $2');\n    }\n    // Clean up Google TV.\n    if ((data = /\\bGoogle TV\\b/.exec(product))) {\n      product = data[0];\n    }\n    // Detect simulators.\n    if (/\\bSimulator\\b/i.test(ua)) {\n      product = (product ? product + ' ' : '') + 'Simulator';\n    }\n    // Detect Opera Mini 8+ running in Turbo/Uncompressed mode on iOS.\n    if (name == 'Opera Mini' && /\\bOPiOS\\b/.test(ua)) {\n      description.push('running in Turbo/Uncompressed mode');\n    }\n    // Detect IE Mobile 11.\n    if (name == 'IE' && /\\blike iPhone OS\\b/.test(ua)) {\n      data = parse(ua.replace(/like iPhone OS/, ''));\n      manufacturer = data.manufacturer;\n      product = data.product;\n    }\n    // Detect iOS.\n    else if (/^iP/.test(product)) {\n      name || (name = 'Safari');\n      os = 'iOS' + ((data = / OS ([\\d_]+)/i.exec(ua))\n        ? ' ' + data[1].replace(/_/g, '.')\n        : '');\n    }\n    // Detect Kubuntu.\n    else if (name == 'Konqueror' && /^Linux\\b/i.test(os)) {\n      os = 'Kubuntu';\n    }\n    // Detect Android browsers.\n    else if ((manufacturer && manufacturer != 'Google' &&\n        ((/Chrome/.test(name) && !/\\bMobile Safari\\b/i.test(ua)) || /\\bVita\\b/.test(product))) ||\n        (/\\bAndroid\\b/.test(os) && /^Chrome/.test(name) && /\\bVersion\\//i.test(ua))) {\n      name = 'Android Browser';\n      os = /\\bAndroid\\b/.test(os) ? os : 'Android';\n    }\n    // Detect Silk desktop/accelerated modes.\n    else if (name == 'Silk') {\n      if (!/\\bMobi/i.test(ua)) {\n        os = 'Android';\n        description.unshift('desktop mode');\n      }\n      if (/Accelerated *= *true/i.test(ua)) {\n        description.unshift('accelerated');\n      }\n    }\n    // Detect UC Browser speed mode.\n    else if (name == 'UC Browser' && /\\bUCWEB\\b/.test(ua)) {\n      description.push('speed mode');\n    }\n    // Detect PaleMoon identifying as Firefox.\n    else if (name == 'PaleMoon' && (data = /\\bFirefox\\/([\\d.]+)\\b/.exec(ua))) {\n      description.push('identifying as Firefox ' + data[1]);\n    }\n    // Detect Firefox OS and products running Firefox.\n    else if (name == 'Firefox' && (data = /\\b(Mobile|Tablet|TV)\\b/i.exec(ua))) {\n      os || (os = 'Firefox OS');\n      product || (product = data[1]);\n    }\n    // Detect false positives for Firefox/Safari.\n    else if (!name || (data = !/\\bMinefield\\b/i.test(ua) && /\\b(?:Firefox|Safari)\\b/.exec(name))) {\n      // Escape the `/` for Firefox 1.\n      if (name && !product && /[\\/,]|^[^(]+?\\)/.test(ua.slice(ua.indexOf(data + '/') + 8))) {\n        // Clear name of false positives.\n        name = null;\n      }\n      // Reassign a generic name.\n      if ((data = product || manufacturer || os) &&\n          (product || manufacturer || /\\b(?:Android|Symbian OS|Tablet OS|webOS)\\b/.test(os))) {\n        name = /[a-z]+(?: Hat)?/i.exec(/\\bAndroid\\b/.test(os) ? os : data) + ' Browser';\n      }\n    }\n    // Add Chrome version to description for Electron.\n    else if (name == 'Electron' && (data = (/\\bChrome\\/([\\d.]+)\\b/.exec(ua) || 0)[1])) {\n      description.push('Chromium ' + data);\n    }\n    // Detect non-Opera (Presto-based) versions (order is important).\n    if (!version) {\n      version = getVersion([\n        '(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\\\d.]+$)|UCBrowser|YaBrowser)',\n        'Version',\n        qualify(name),\n        '(?:Firefox|Minefield|NetFront)'\n      ]);\n    }\n    // Detect stubborn layout engines.\n    if ((data =\n          layout == 'iCab' && parseFloat(version) > 3 && 'WebKit' ||\n          /\\bOpera\\b/.test(name) && (/\\bOPR\\b/.test(ua) ? 'Blink' : 'Presto') ||\n          /\\b(?:Midori|Nook|Safari)\\b/i.test(ua) && !/^(?:Trident|EdgeHTML)$/.test(layout) && 'WebKit' ||\n          !layout && /\\bMSIE\\b/i.test(ua) && (os == 'Mac OS' ? 'Tasman' : 'Trident') ||\n          layout == 'WebKit' && /\\bPlayStation\\b(?! Vita\\b)/i.test(name) && 'NetFront'\n        )) {\n      layout = [data];\n    }\n    // Detect Windows Phone 7 desktop mode.\n    if (name == 'IE' && (data = (/; *(?:XBLWP|ZuneWP)(\\d+)/i.exec(ua) || 0)[1])) {\n      name += ' Mobile';\n      os = 'Windows Phone ' + (/\\+$/.test(data) ? data : data + '.x');\n      description.unshift('desktop mode');\n    }\n    // Detect Windows Phone 8.x desktop mode.\n    else if (/\\bWPDesktop\\b/i.test(ua)) {\n      name = 'IE Mobile';\n      os = 'Windows Phone 8.x';\n      description.unshift('desktop mode');\n      version || (version = (/\\brv:([\\d.]+)/.exec(ua) || 0)[1]);\n    }\n    // Detect IE 11 identifying as other browsers.\n    else if (name != 'IE' && layout == 'Trident' && (data = /\\brv:([\\d.]+)/.exec(ua))) {\n      if (name) {\n        description.push('identifying as ' + name + (version ? ' ' + version : ''));\n      }\n      name = 'IE';\n      version = data[1];\n    }\n    // Leverage environment features.\n    if (useFeatures) {\n      // Detect server-side environments.\n      // Rhino has a global function while others have a global object.\n      if (isHostType(context, 'global')) {\n        if (java) {\n          data = java.lang.System;\n          arch = data.getProperty('os.arch');\n          os = os || data.getProperty('os.name') + ' ' + data.getProperty('os.version');\n        }\n        if (rhino) {\n          try {\n            version = context.require('ringo/engine').version.join('.');\n            name = 'RingoJS';\n          } catch(e) {\n            if ((data = context.system) && data.global.system == context.system) {\n              name = 'Narwhal';\n              os || (os = data[0].os || null);\n            }\n          }\n          if (!name) {\n            name = 'Rhino';\n          }\n        }\n        else if (\n          typeof context.process == 'object' && !context.process.browser &&\n          (data = context.process)\n        ) {\n          if (typeof data.versions == 'object') {\n            if (typeof data.versions.electron == 'string') {\n              description.push('Node ' + data.versions.node);\n              name = 'Electron';\n              version = data.versions.electron;\n            } else if (typeof data.versions.nw == 'string') {\n              description.push('Chromium ' + version, 'Node ' + data.versions.node);\n              name = 'NW.js';\n              version = data.versions.nw;\n            }\n          }\n          if (!name) {\n            name = 'Node.js';\n            arch = data.arch;\n            os = data.platform;\n            version = /[\\d.]+/.exec(data.version);\n            version = version ? version[0] : null;\n          }\n        }\n      }\n      // Detect Adobe AIR.\n      else if (getClassOf((data = context.runtime)) == airRuntimeClass) {\n        name = 'Adobe AIR';\n        os = data.flash.system.Capabilities.os;\n      }\n      // Detect PhantomJS.\n      else if (getClassOf((data = context.phantom)) == phantomClass) {\n        name = 'PhantomJS';\n        version = (data = data.version || null) && (data.major + '.' + data.minor + '.' + data.patch);\n      }\n      // Detect IE compatibility modes.\n      else if (typeof doc.documentMode == 'number' && (data = /\\bTrident\\/(\\d+)/i.exec(ua))) {\n        // We're in compatibility mode when the Trident version + 4 doesn't\n        // equal the document mode.\n        version = [version, doc.documentMode];\n        if ((data = +data[1] + 4) != version[1]) {\n          description.push('IE ' + version[1] + ' mode');\n          layout && (layout[1] = '');\n          version[1] = data;\n        }\n        version = name == 'IE' ? String(version[1].toFixed(1)) : version[0];\n      }\n      // Detect IE 11 masking as other browsers.\n      else if (typeof doc.documentMode == 'number' && /^(?:Chrome|Firefox)\\b/.test(name)) {\n        description.push('masking as ' + name + ' ' + version);\n        name = 'IE';\n        version = '11.0';\n        layout = ['Trident'];\n        os = 'Windows';\n      }\n      os = os && format(os);\n    }\n    // Detect prerelease phases.\n    if (version && (data =\n          /(?:[ab]|dp|pre|[ab]\\d+pre)(?:\\d+\\+?)?$/i.exec(version) ||\n          /(?:alpha|beta)(?: ?\\d)?/i.exec(ua + ';' + (useFeatures && nav.appMinorVersion)) ||\n          /\\bMinefield\\b/i.test(ua) && 'a'\n        )) {\n      prerelease = /b/i.test(data) ? 'beta' : 'alpha';\n      version = version.replace(RegExp(data + '\\\\+?$'), '') +\n        (prerelease == 'beta' ? beta : alpha) + (/\\d+\\+?/.exec(data) || '');\n    }\n    // Detect Firefox Mobile.\n    if (name == 'Fennec' || name == 'Firefox' && /\\b(?:Android|Firefox OS|KaiOS)\\b/.test(os)) {\n      name = 'Firefox Mobile';\n    }\n    // Obscure Maxthon's unreliable version.\n    else if (name == 'Maxthon' && version) {\n      version = version.replace(/\\.[\\d.]+/, '.x');\n    }\n    // Detect Xbox 360 and Xbox One.\n    else if (/\\bXbox\\b/i.test(product)) {\n      if (product == 'Xbox 360') {\n        os = null;\n      }\n      if (product == 'Xbox 360' && /\\bIEMobile\\b/.test(ua)) {\n        description.unshift('mobile mode');\n      }\n    }\n    // Add mobile postfix.\n    else if ((/^(?:Chrome|IE|Opera)$/.test(name) || name && !product && !/Browser|Mobi/.test(name)) &&\n        (os == 'Windows CE' || /Mobi/i.test(ua))) {\n      name += ' Mobile';\n    }\n    // Detect IE platform preview.\n    else if (name == 'IE' && useFeatures) {\n      try {\n        if (context.external === null) {\n          description.unshift('platform preview');\n        }\n      } catch(e) {\n        description.unshift('embedded');\n      }\n    }\n    // Detect BlackBerry OS version.\n    // http://docs.blackberry.com/en/developers/deliverables/18169/HTTP_headers_sent_by_BB_Browser_1234911_11.jsp\n    else if ((/\\bBlackBerry\\b/.test(product) || /\\bBB10\\b/.test(ua)) && (data =\n          (RegExp(product.replace(/ +/g, ' *') + '/([.\\\\d]+)', 'i').exec(ua) || 0)[1] ||\n          version\n        )) {\n      data = [data, /BB10/.test(ua)];\n      os = (data[1] ? (product = null, manufacturer = 'BlackBerry') : 'Device Software') + ' ' + data[0];\n      version = null;\n    }\n    // Detect Opera identifying/masking itself as another browser.\n    // http://www.opera.com/support/kb/view/843/\n    else if (this != forOwn && product != 'Wii' && (\n          (useFeatures && opera) ||\n          (/Opera/.test(name) && /\\b(?:MSIE|Firefox)\\b/i.test(ua)) ||\n          (name == 'Firefox' && /\\bOS X (?:\\d+\\.){2,}/.test(os)) ||\n          (name == 'IE' && (\n            (os && !/^Win/.test(os) && version > 5.5) ||\n            /\\bWindows XP\\b/.test(os) && version > 8 ||\n            version == 8 && !/\\bTrident\\b/.test(ua)\n          ))\n        ) && !reOpera.test((data = parse.call(forOwn, ua.replace(reOpera, '') + ';'))) && data.name) {\n      // When \"identifying\", the UA contains both Opera and the other browser's name.\n      data = 'ing as ' + data.name + ((data = data.version) ? ' ' + data : '');\n      if (reOpera.test(name)) {\n        if (/\\bIE\\b/.test(data) && os == 'Mac OS') {\n          os = null;\n        }\n        data = 'identify' + data;\n      }\n      // When \"masking\", the UA contains only the other browser's name.\n      else {\n        data = 'mask' + data;\n        if (operaClass) {\n          name = format(operaClass.replace(/([a-z])([A-Z])/g, '$1 $2'));\n        } else {\n          name = 'Opera';\n        }\n        if (/\\bIE\\b/.test(data)) {\n          os = null;\n        }\n        if (!useFeatures) {\n          version = null;\n        }\n      }\n      layout = ['Presto'];\n      description.push(data);\n    }\n    // Detect WebKit Nightly and approximate Chrome/Safari versions.\n    if ((data = (/\\bAppleWebKit\\/([\\d.]+\\+?)/i.exec(ua) || 0)[1])) {\n      // Correct build number for numeric comparison.\n      // (e.g. \"532.5\" becomes \"532.05\")\n      data = [parseFloat(data.replace(/\\.(\\d)$/, '.0$1')), data];\n      // Nightly builds are postfixed with a \"+\".\n      if (name == 'Safari' && data[1].slice(-1) == '+') {\n        name = 'WebKit Nightly';\n        prerelease = 'alpha';\n        version = data[1].slice(0, -1);\n      }\n      // Clear incorrect browser versions.\n      else if (version == data[1] ||\n          version == (data[2] = (/\\bSafari\\/([\\d.]+\\+?)/i.exec(ua) || 0)[1])) {\n        version = null;\n      }\n      // Use the full Chrome version when available.\n      data[1] = (/\\b(?:Headless)?Chrome\\/([\\d.]+)/i.exec(ua) || 0)[1];\n      // Detect Blink layout engine.\n      if (data[0] == 537.36 && data[2] == 537.36 && parseFloat(data[1]) >= 28 && layout == 'WebKit') {\n        layout = ['Blink'];\n      }\n      // Detect JavaScriptCore.\n      // http://stackoverflow.com/questions/6768474/how-can-i-detect-which-javascript-engine-v8-or-jsc-is-used-at-runtime-in-androi\n      if (!useFeatures || (!likeChrome && !data[1])) {\n        layout && (layout[1] = 'like Safari');\n        data = (data = data[0], data < 400 ? 1 : data < 500 ? 2 : data < 526 ? 3 : data < 533 ? 4 : data < 534 ? '4+' : data < 535 ? 5 : data < 537 ? 6 : data < 538 ? 7 : data < 601 ? 8 : data < 602 ? 9 : data < 604 ? 10 : data < 606 ? 11 : data < 608 ? 12 : '12');\n      } else {\n        layout && (layout[1] = 'like Chrome');\n        data = data[1] || (data = data[0], data < 530 ? 1 : data < 532 ? 2 : data < 532.05 ? 3 : data < 533 ? 4 : data < 534.03 ? 5 : data < 534.07 ? 6 : data < 534.10 ? 7 : data < 534.13 ? 8 : data < 534.16 ? 9 : data < 534.24 ? 10 : data < 534.30 ? 11 : data < 535.01 ? 12 : data < 535.02 ? '13+' : data < 535.07 ? 15 : data < 535.11 ? 16 : data < 535.19 ? 17 : data < 536.05 ? 18 : data < 536.10 ? 19 : data < 537.01 ? 20 : data < 537.11 ? '21+' : data < 537.13 ? 23 : data < 537.18 ? 24 : data < 537.24 ? 25 : data < 537.36 ? 26 : layout != 'Blink' ? '27' : '28');\n      }\n      // Add the postfix of \".x\" or \"+\" for approximate versions.\n      layout && (layout[1] += ' ' + (data += typeof data == 'number' ? '.x' : /[.+]/.test(data) ? '' : '+'));\n      // Obscure version for some Safari 1-2 releases.\n      if (name == 'Safari' && (!version || parseInt(version) > 45)) {\n        version = data;\n      } else if (name == 'Chrome' && /\\bHeadlessChrome/i.test(ua)) {\n        description.unshift('headless');\n      }\n    }\n    // Detect Opera desktop modes.\n    if (name == 'Opera' &&  (data = /\\bzbov|zvav$/.exec(os))) {\n      name += ' ';\n      description.unshift('desktop mode');\n      if (data == 'zvav') {\n        name += 'Mini';\n        version = null;\n      } else {\n        name += 'Mobile';\n      }\n      os = os.replace(RegExp(' *' + data + '$'), '');\n    }\n    // Detect Chrome desktop mode.\n    else if (name == 'Safari' && /\\bChrome\\b/.exec(layout && layout[1])) {\n      description.unshift('desktop mode');\n      name = 'Chrome Mobile';\n      version = null;\n\n      if (/\\bOS X\\b/.test(os)) {\n        manufacturer = 'Apple';\n        os = 'iOS 4.3+';\n      } else {\n        os = null;\n      }\n    }\n    // Newer versions of SRWare Iron uses the Chrome tag to indicate its version number.\n    else if (/\\bSRWare Iron\\b/.test(name) && !version) {\n      version = getVersion('Chrome');\n    }\n    // Strip incorrect OS versions.\n    if (version && version.indexOf((data = /[\\d.]+$/.exec(os))) == 0 &&\n        ua.indexOf('/' + data + '-') > -1) {\n      os = trim(os.replace(data, ''));\n    }\n    // Ensure OS does not include the browser name.\n    if (os && os.indexOf(name) != -1 && !RegExp(name + ' OS').test(os)) {\n      os = os.replace(RegExp(' *' + qualify(name) + ' *'), '');\n    }\n    // Add layout engine.\n    if (layout && !/\\b(?:Avant|Nook)\\b/.test(name) && (\n        /Browser|Lunascape|Maxthon/.test(name) ||\n        name != 'Safari' && /^iOS/.test(os) && /\\bSafari\\b/.test(layout[1]) ||\n        /^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(name) && layout[1])) {\n      // Don't add layout details to description if they are falsey.\n      (data = layout[layout.length - 1]) && description.push(data);\n    }\n    // Combine contextual information.\n    if (description.length) {\n      description = ['(' + description.join('; ') + ')'];\n    }\n    // Append manufacturer to description.\n    if (manufacturer && product && product.indexOf(manufacturer) < 0) {\n      description.push('on ' + manufacturer);\n    }\n    // Append product to description.\n    if (product) {\n      description.push((/^on /.test(description[description.length - 1]) ? '' : 'on ') + product);\n    }\n    // Parse the OS into an object.\n    if (os) {\n      data = / ([\\d.+]+)$/.exec(os);\n      isSpecialCasedOS = data && os.charAt(os.length - data[0].length - 1) == '/';\n      os = {\n        'architecture': 32,\n        'family': (data && !isSpecialCasedOS) ? os.replace(data[0], '') : os,\n        'version': data ? data[1] : null,\n        'toString': function() {\n          var version = this.version;\n          return this.family + ((version && !isSpecialCasedOS) ? ' ' + version : '') + (this.architecture == 64 ? ' 64-bit' : '');\n        }\n      };\n    }\n    // Add browser/OS architecture.\n    if ((data = /\\b(?:AMD|IA|Win|WOW|x86_|x)64\\b/i.exec(arch)) && !/\\bi686\\b/i.test(arch)) {\n      if (os) {\n        os.architecture = 64;\n        os.family = os.family.replace(RegExp(' *' + data), '');\n      }\n      if (\n          name && (/\\bWOW64\\b/i.test(ua) ||\n          (useFeatures && /\\w(?:86|32)$/.test(nav.cpuClass || nav.platform) && !/\\bWin64; x64\\b/i.test(ua)))\n      ) {\n        description.unshift('32-bit');\n      }\n    }\n    // Chrome 39 and above on OS X is always 64-bit.\n    else if (\n        os && /^OS X/.test(os.family) &&\n        name == 'Chrome' && parseFloat(version) >= 39\n    ) {\n      os.architecture = 64;\n    }\n\n    ua || (ua = null);\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * The platform object.\n     *\n     * @name platform\n     * @type Object\n     */\n    var platform = {};\n\n    /**\n     * The platform description.\n     *\n     * @memberOf platform\n     * @type string|null\n     */\n    platform.description = ua;\n\n    /**\n     * The name of the browser's layout engine.\n     *\n     * The list of common layout engines include:\n     * \"Blink\", \"EdgeHTML\", \"Gecko\", \"Trident\" and \"WebKit\"\n     *\n     * @memberOf platform\n     * @type string|null\n     */\n    platform.layout = layout && layout[0];\n\n    /**\n     * The name of the product's manufacturer.\n     *\n     * The list of manufacturers include:\n     * \"Apple\", \"Archos\", \"Amazon\", \"Asus\", \"Barnes & Noble\", \"BlackBerry\",\n     * \"Google\", \"HP\", \"HTC\", \"LG\", \"Microsoft\", \"Motorola\", \"Nintendo\",\n     * \"Nokia\", \"Samsung\" and \"Sony\"\n     *\n     * @memberOf platform\n     * @type string|null\n     */\n    platform.manufacturer = manufacturer;\n\n    /**\n     * The name of the browser/environment.\n     *\n     * The list of common browser names include:\n     * \"Chrome\", \"Electron\", \"Firefox\", \"Firefox for iOS\", \"IE\",\n     * \"Microsoft Edge\", \"PhantomJS\", \"Safari\", \"SeaMonkey\", \"Silk\",\n     * \"Opera Mini\" and \"Opera\"\n     *\n     * Mobile versions of some browsers have \"Mobile\" appended to their name:\n     * eg. \"Chrome Mobile\", \"Firefox Mobile\", \"IE Mobile\" and \"Opera Mobile\"\n     *\n     * @memberOf platform\n     * @type string|null\n     */\n    platform.name = name;\n\n    /**\n     * The alpha/beta release indicator.\n     *\n     * @memberOf platform\n     * @type string|null\n     */\n    platform.prerelease = prerelease;\n\n    /**\n     * The name of the product hosting the browser.\n     *\n     * The list of common products include:\n     *\n     * \"BlackBerry\", \"Galaxy S4\", \"Lumia\", \"iPad\", \"iPod\", \"iPhone\", \"Kindle\",\n     * \"Kindle Fire\", \"Nexus\", \"Nook\", \"PlayBook\", \"TouchPad\" and \"Transformer\"\n     *\n     * @memberOf platform\n     * @type string|null\n     */\n    platform.product = product;\n\n    /**\n     * The browser's user agent string.\n     *\n     * @memberOf platform\n     * @type string|null\n     */\n    platform.ua = ua;\n\n    /**\n     * The browser/environment version.\n     *\n     * @memberOf platform\n     * @type string|null\n     */\n    platform.version = name && version;\n\n    /**\n     * The name of the operating system.\n     *\n     * @memberOf platform\n     * @type Object\n     */\n    platform.os = os || {\n\n      /**\n       * The CPU architecture the OS is built for.\n       *\n       * @memberOf platform.os\n       * @type number|null\n       */\n      'architecture': null,\n\n      /**\n       * The family of the OS.\n       *\n       * Common values include:\n       * \"Windows\", \"Windows Server 2008 R2 / 7\", \"Windows Server 2008 / Vista\",\n       * \"Windows XP\", \"OS X\", \"Linux\", \"Ubuntu\", \"Debian\", \"Fedora\", \"Red Hat\",\n       * \"SuSE\", \"Android\", \"iOS\" and \"Windows Phone\"\n       *\n       * @memberOf platform.os\n       * @type string|null\n       */\n      'family': null,\n\n      /**\n       * The version of the OS.\n       *\n       * @memberOf platform.os\n       * @type string|null\n       */\n      'version': null,\n\n      /**\n       * Returns the OS string.\n       *\n       * @memberOf platform.os\n       * @returns {string} The OS string.\n       */\n      'toString': function() { return 'null'; }\n    };\n\n    platform.parse = parse;\n    platform.toString = toStringPlatform;\n\n    if (platform.version) {\n      description.unshift(version);\n    }\n    if (platform.name) {\n      description.unshift(name);\n    }\n    if (os && name && !(os == String(os).split(' ')[0] && (os == name.split(' ')[0] || product))) {\n      description.push(product ? '(' + os + ')' : 'on ' + os);\n    }\n    if (description.length) {\n      platform.description = description.join(' ');\n    }\n    return platform;\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  // Export platform.\n  var platform = parse();\n\n  // Some AMD build optimizers, like r.js, check for condition patterns like the following:\n  if (typeof define == 'function' && typeof define.amd == 'object' && define.amd) {\n    // Expose platform on the global object to prevent errors when platform is\n    // loaded by a script tag in the presence of an AMD loader.\n    // See http://requirejs.org/docs/errors.html#mismatch for more details.\n    root.platform = platform;\n\n    // Define as an anonymous module so platform can be aliased through path mapping.\n    define(function() {\n      return platform;\n    });\n  }\n  // Check for `exports` after `define` in case a build optimizer adds an `exports` object.\n  else if (freeExports && freeModule) {\n    // Export for CommonJS support.\n    forOwn(platform, function(value, key) {\n      freeExports[key] = value;\n    });\n  }\n  else {\n    // Export to the global object.\n    root.platform = platform;\n  }\n}.call(this));\n","import { API_ORIGIN, API_URL } from '../constants';\nimport { MetricSurveysData, XRAnalytics } from '../types';\n\nexport async function sendXRAnalyticsData(data: XRAnalytics.Record | XRAnalytics.BatchRecord) {\n  console.log('poll', data);\n\n  return fetch(`${API_URL}/xr-analytics`, {\n    method: 'POST',\n    keepalive: true,\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(data),\n  });\n}\n\nexport async function sendMetricSurveysData(data: MetricSurveysData) {\n  console.log('survey data', data);\n\n  return fetch(`${API_ORIGIN}/api/v1/metric-surveys`, {\n    method: 'POST',\n    keepalive: true,\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(data),\n  });\n}\n","export const isProduction = process.env.NODE_ENV === 'production';\nexport const isStaging = process.env.NODE_ENV === 'staging';\nexport const API_ORIGIN = isProduction\n  ? 'https://app.metalitix.com'\n  : isStaging\n  ? 'https://metalitix-staging.aircards.io'\n  : 'https://metalitix-dev.aircards.io';\nexport const API_VERSION = 'v1';\nexport const API_URL = `${API_ORIGIN}/api/${API_VERSION}`;\n\nexport const MIN_INTERVAL_VALUE = 100;\nexport const MAX_INTERVAL_VALUE = 1000;\nexport const DEFAULT_INTERVAL_VALUE = 500;\n\nexport const MAXIMUM_BATCH_RECORDS_LENGTH = 100;\n/** Wait maximum 3 minutes if limit of MAXIMUM_BATCH_RECORDS_LENGTH was not reached */\nexport const MAXIMUM_BATCH_SENDING_INTERVAL = 3 * 60 * 1000;\n/** Maximum server keepalive time since last successful pull data to the server */\nexport const MAXIMUM_SESSION_KEEPALIVE_TIME = 5 * 60 * 1000;\n","export interface MetalitixLoggerOptions {\n  pollInterval?: number;\n  apiVersion?: string;\n  userMeta?: Partial<XRAnalytics.UserMetadata>;\n  showSurvey?: boolean;\n  surveyTheme?: SurveyTheme;\n}\n\nexport type SurveyTheme = 'white' | 'black';\n\nexport interface AddSurveyProps {\n  appkey: string;\n  sessionId: string;\n  /** If user trigger the survey manually - it will always show the survey popup even if user already submitted it once */\n  force?: boolean;\n  theme?: SurveyTheme;\n}\n\nexport interface MetricSurveysData {\n  sessionId: string;\n  appkey: string;\n  rating: number;\n}\n\nexport interface Vector2D {\n  x: number;\n  y: number;\n}\n\nexport interface Vector3D {\n  x: number;\n  y: number;\n  z: number;\n}\n\nexport namespace XRAnalytics {\n  export enum PointStates {\n    Pressed = 'state.pressed',\n    Updated = 'state.updated',\n    Released = 'state.released',\n    Stationary = 'state.stationary',\n  }\n\n  export const KnownPointStates = Object.values(PointStates);\n\n  export enum UserInteractionTypes {\n    KeyDown = 'user.interaction.key_down',\n    KeyPress = 'user.interaction.key_press',\n    KeyUp = 'user.interaction.key_down',\n    MouseEnter = 'user.interaction.mouse_enter',\n    MouseLeave = 'user.interaction.mouse_leave',\n    MouseOver = 'user.interaction.mouse_over',\n    MouseOut = 'user.interaction.mouse_out',\n    MouseDown = 'user.interaction.mouse_down',\n    MouseUp = 'user.interaction.mouse_up',\n    MouseMove = 'user.interaction.mouse_move',\n    MousePress = 'user.interaction.mouse_press',\n    TouchTap = 'user.interaction.touch_tap',\n    TouchStart = 'user.interaction.touch_start',\n    TouchMove = 'user.interaction.touch_move',\n    TouchEnd = 'user.interaction.touch_end',\n    ZoomStart = 'user.interaction.zoom_start',\n    ZoomUpdate = 'user.interaction.zoom_update',\n    ZoomEnd = 'user.interaction.zoom_end',\n  }\n\n  export const KnownUserInteractionTypes = Object.values(UserInteractionTypes);\n\n  /**\n   * XR Analytic Log Record Event Point\n   * - describes event point params\n   * @typedef {object} XRAnalyticEventPoint\n   * @property {string} state - point state\n   * @property {number} timestamp - timestamp in msec or ISO string\n   * @property {oneOf|Vector2D|Vector3D} timestamp - timestamp in msec or ISO string\n   */\n  export interface EventPoint {\n    state: PointStates;\n    timestamp: number;\n    position: Vector2D | Vector3D;\n  }\n\n  /**\n   * XR Analytic Log Record User Event\n   * - describes user events params\n   * @typedef {object} XRAnalyticUserEvent\n   * @property {string} object - `user.event`\n   * @property {string} eventName - human-readable event name\n   * @property {string} eventType - event type identifier\n   * @property {string} target - optional field which describes target of this event\n   * @property {array<XRAnalyticEventPoint>} points - multiple points (for multi-touch) or single point\n   * @property {object} params - any additional params\n   */\n  export interface UserEvent {\n    object: string;\n    eventName: string;\n    eventType: UserInteractionTypes | string;\n    target?: string | EventPoint | any;\n    points?: EventPoint[];\n    params?: object;\n  }\n\n  export enum EventTypes {\n    UserPosition = 'event.user.position',\n    UserInteraction = 'event.user.interaction',\n    SessionStart = 'event.session.start',\n    SessionUpdate = 'event.session.update',\n    SessionEnd = 'event.session.end',\n  }\n\n  export const KnownEventTypes = Object.values(EventTypes);\n\n  /**\n   * XR Analytic Log Record User Camera\n   * - describes user camera params\n   * @typedef {object} XRAnalyticUserCamera\n   * @property {number} fieldOfView\n   * @property {number} aspectRatio\n   * @property {number} zNearPlane\n   * @property {number} zFarPlane\n   */\n  export interface UserCamera {\n    fieldOfView: number;\n    aspectRatio: number;\n    zNearPlane: number;\n    zFarPlane: number;\n  }\n\n  /**\n   * XR Analytic Log Record User Metadata\n   * - can contain different fields related to user client.\n   * These list of fields is approximate and all fields are optional.\n   * @typedef {object} XRAnalyticUserMetadata\n   * @property {string} ipAddress - user ip address\n   * @property {string} geolocation - user geolocation\n   * @property {string} userAgent - user client user-agent string\n   * @property {string} pagePath - current page\n   * @property {string} pageQuery - current query params\n   * @property {string} sceneName - current scene name\n   * @property {string} gameLocation - current map / in-game location\n   * @property {object} systemInfo - free dictionary of sys info (like OS ver or etc.)\n   * @property {object} params - any additional params\n   */\n  export interface UserMetadata {\n    ipAddress: string;\n    geolocation: string;\n    userAgent: string;\n    pagePath: string;\n    pageQuery: string;\n    sceneName: string;\n    gameLocation: string;\n    systemInfo: MetadataSystemInfo;\n    params: object;\n  }\n\n  /**\n   * XR Analytic Log Record Metadata System Info\n   * - can contain different fields related to user client.\n   * These list of fields is approximate and all fields are optional.\n   * @typedef {object} XRAnalyticUserMetadata\n   * @property {string} deviceModel - user device model\n   * @property {string} deviceName - user device name\n   * @property {string} deviceType - user device type\n   * @property {string} operatingSystemName - name of the user operating system\n   * @property {string} operatingSystemVersion - version of the user operating system\n   */\n  export interface MetadataSystemInfo {\n    deviceModel?: string;\n    deviceName?: string;\n    deviceType?: string;\n    operatingSystemName?: string;\n    operatingSystemVersion?: string;\n  }\n\n  /**\n   * XR Analytic Log Record User Position\n   * - contain position, direction and optionally any additional custom fields\n   * @typedef {object} XRAnalyticRecordData\n   * @property {Vector3D} position - user position\n   * @property {Vector3D} direction - look at direction\n   */\n  export interface Data {\n    position: Vector3D;\n    direction: Vector3D;\n    [k: string]: any;\n  }\n\n  /**\n   * XR Analytic Log RecordBase\n   * @typedef {object} XRAnalyticRecord\n   * @property {string} appkey - project API key\n   * @property {string} apiver - expected to be `'v2'`\n   * @property {string} sessionId - session uuid\n   * @property {number} timestamp - timestamp in msec or ISO string date\n   * @property {XRAnalyticRecordData} data - user position and direction on the scene. Can contain any additional custom fields.\n   * @property {XRAnalyticUserMetadata} userMeta - required field describing client metadata.\n   */\n  export interface RecordBase {\n    object: string;\n    sessionId: string;\n    timestamp: number;\n    appkey: string;\n    apiver: string;\n    metrics: {\n      fps: number;\n    };\n    data: Data;\n    userMeta: Partial<UserMetadata>;\n  }\n\n  /**\n   * XR Analytic Log RecordDataFields\n   * @typedef {object} XRAnalyticRecord\n   * @property {XRAnalyticRecordData} data - user position and direction on the scene. Can contain any additional custom fields.\n   * @property {XRAnalyticUserMetadata} userMeta - field describing client metadata.\n   * @property {XRAnalyticUserCamera} camera - field describing user camera, actual for `event.user.session.start` and `event.user.session.update` events\n   * @property {XRAnalyticUserEvent} userEvent - field describing event, actual for `event.user.interaction` events\n   */\n  export interface RecordDataFields {\n    data: Data;\n    userMeta: Partial<UserMetadata>;\n    camera?: UserCamera;\n    userEvent?: UserEvent;\n  }\n\n  /**\n   * XR Analytic Log SessionStartRecord\n   * @typedef {object} XRAnalyticRecord\n   * @property {string} eventType - EventTypes.SessionStart event type\n   * @property {string} appkey - project API key\n   * @property {string} apiver - expected to be `'v2'`\n   * @property {string} sessionId - session uuid\n   * @property {number} timestamp - timestamp in msec or ISO string date\n   * @property {XRAnalyticUserCamera} camera - required field describing user camera, actual for `event.user.session.start` and `event.user.session.update` events\n   * @property {XRAnalyticRecordData} data - user position and direction on the scene. Can contain any additional custom fields.\n   */\n  export interface SessionStartRecord extends RecordBase {\n    eventType: EventTypes.SessionStart;\n    camera: UserCamera;\n  }\n\n  /**\n   * XR Analytic Log SessionUpdateRecord\n   * @typedef {object} XRAnalyticRecord\n   * @property {string} eventType - EventTypes.SessionUpdate event type\n   * @property {string} appkey - project API key\n   * @property {string} apiver - expected to be `'v2'`\n   * @property {string} sessionId - session uuid\n   * @property {number} timestamp - timestamp in msec or ISO string date\n   * @property {XRAnalyticUserCamera} camera - optional field describing user camera, actual for `event.user.session.start` and `event.user.session.update` events\n   * @property {XRAnalyticRecordData} data - user position and direction on the scene. Can contain any additional custom fields.\n   */\n  export interface SessionUpdateRecord extends RecordBase {\n    eventType: EventTypes.SessionUpdate;\n    camera?: UserCamera;\n  }\n\n  /**\n   * XR Analytic Log SessionEndRecord\n   * @typedef {object} XRAnalyticRecord\n   * @property {string} eventType - EventTypes.SessionEnd event type\n   * @property {string} appkey - project API key\n   * @property {string} apiver - expected to be `'v2'`\n   * @property {string} sessionId - session uuid\n   * @property {number} timestamp - timestamp in msec or ISO string date\n   * @property {XRAnalyticUserCamera} camera - optional field describing user camera, actual for `event.user.session.start` and `event.user.session.update` events\n   * @property {XRAnalyticRecordData} data - user position and direction on the scene. Can contain any additional custom fields.\n   */\n  export interface SessionEndRecord extends RecordBase {\n    eventType: EventTypes.SessionEnd;\n    camera?: UserCamera;\n  }\n\n  /**\n   * XR Analytic Log UserPositionRecord\n   * @typedef {object} XRAnalyticRecord\n   * @property {string} eventType - EventTypes.UserPosition event type\n   * @property {string} appkey - project API key\n   * @property {string} apiver - expected to be `'v2'`\n   * @property {string} sessionId - session uuid\n   * @property {number} timestamp - timestamp in msec or ISO string date\n   * @property {XRAnalyticRecordData} data - user position and direction on the scene. Can contain any additional custom fields.\n   */\n  export interface UserPositionRecord extends RecordBase {\n    eventType: EventTypes.UserPosition;\n  }\n\n  /**\n   * XR Analytic Log UserInteractionRecord\n   * @typedef {object} XRAnalyticRecord\n   * @property {string} eventType - EventTypes.UserPosition event type\n   * @property {string} appkey - project API key\n   * @property {string} apiver - expected to be `'v2'`\n   * @property {string} sessionId - session uuid\n   * @property {number} timestamp - timestamp in msec or ISO string date\n   * @property {XRAnalyticUserEvent} userEvent - required field describing event, actual for `event.user.interaction` events\n   * @property {XRAnalyticRecordData} data - user position and direction on the scene. Can contain any additional custom fields.\n   */\n  export interface UserInteractionRecord extends RecordBase {\n    eventType: EventTypes.UserInteraction;\n    userEvent: UserEvent;\n  }\n\n  /**\n   * XR Analytic Log Record\n   * @typedef {object} XRAnalyticRecord\n   * @property {string} eventType - supported event types\n   * @property {string} appkey - project API key\n   * @property {string} apiver - expected to be `'v2'`\n   * @property {string} sessionId - session uuid\n   * @property {number} timestamp - timestamp in msec or ISO string date\n   * @property {XRAnalyticUserEvent} userEvent - field describing event, actual for `event.user.interaction` events\n   * @property {XRAnalyticUserMetadata} userMeta - field describing client metadata, actual for `event.user.session.start` and `event.user.session.update` events\n   * @property {XRAnalyticUserCamera} camera - field describing user camera, actual for `event.user.session.start` and `event.user.session.update` events\n   * @property {XRAnalyticRecordData} data - user position and direction on the scene. Can contain any additional custom fields.\n   */\n  export type Record =\n    | SessionStartRecord\n    | SessionUpdateRecord\n    | SessionEndRecord\n    | UserPositionRecord\n    | UserInteractionRecord;\n\n  /**\n   * XR Analytic Log Batch Records\n   * @typedef {object} XRAnalyticBatchRecord\n   * @property {string} appkey - project API key\n   * @property {string} apiver - expected to be `'v2'`\n   * @property {array<XRAnalyticRecord>} items - array of individual events\n   */\n  export interface BatchRecord {\n    object: string;\n    appkey: string;\n    apiver: string;\n    items: Record[];\n  }\n}\n","export function deepEqual(x: any, y: any): boolean {\n  const ok = Object.keys;\n  const tx = typeof x;\n  const ty = typeof y;\n\n  return x && y && tx === 'object' && tx === ty\n    ? ok(x).length === ok(y).length && ok(x).every(key => deepEqual(x[key], y[key]))\n    : x === y;\n}\n\nexport function isObject(item: any): item is Object {\n  return item && typeof item === 'object' && !Array.isArray(item);\n}\n\nexport function mergeDeep(target: any, source: any) {\n  let output = Object.assign({}, target);\n  if (isObject(target) && isObject(source)) {\n    Object.keys(source).forEach(key => {\n      if (isObject(source[key])) {\n        if (!(key in target)) Object.assign(output, { [key]: source[key] });\n        else output[key] = mergeDeep(target[key], source[key]);\n      } else {\n        Object.assign(output, { [key]: source[key] });\n      }\n    });\n  }\n  return output;\n}\n\nexport const userAgent = window.navigator.userAgent;\n\nexport const isTablet =\n  /(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/i.test(\n    userAgent,\n  );\nexport const isMobile =\n  /Mobile|iP(hone|od|ad)|Android|BlackBerry|IEMobile|Kindle|NetFront|Silk-Accelerated|(hpw|web)OS|Fennec|Minimo|Opera M(obi|ini)|Blazer|Dolfin|Dolphin|Skyfire|Zune/.test(\n    userAgent,\n  );\nexport const deviceType = isMobile ? 'mobile' : isTablet ? 'tablet' : 'desktop';\n","import { sendMetricSurveysData } from '../services';\nimport { AddSurveyProps } from '../types';\n\nconst template = `<style>\n  .mtx-survey {\n    position: fixed;\n    z-index: 2000;\n    top: 0;\n    left: 50%;\n    transform: translate(-50%, -100%);\n    padding: 10px 33px 7px;\n    border-radius: 5px;\n    border: 2px solid #888;\n    transition: transform 0.3s ease-in-out;\n  }\n  \n  .mtx-survey--open {\n    transform: translate(-50%, 35px);\n  }\n  \n  .mtx-survey--close {\n    opacity: 0;\n    transition: transform 0.3s cubic-bezier(.84,-0.23,.41,.78), opacity 0.3s ease-in-out;\n    transform: translate(-50%, 0) scale(0.6);\n  }\n  \n  .mtx-survey--white {\n    background: #fff;\n    color: #292929;\n  }\n  \n  .mtx-survey--black {\n    background: #2d2d2d;\n    color: #fff;\n  }\n  \n  .mtx-survey-title {\n    font-family: 'Rubik', sans-serif;\n    font-style: normal;\n    font-weight: 400;\n    font-size: 14px;\n    line-height: 17px;\n    margin: 0 0 5px;\n    text-align: center;\n  }\n  \n  .mtx-survey-items {\n    text-align: center;\n    margin-bottom: 7px;\n  }\n  \n  .mtx-survey-item {\n    transition: opacity 0.3s ease-in-out;\n    cursor: pointer;\n  }\n  \n  .mtx-survey-submit-holder {\n    text-align: center;\n  }\n  \n  .mtx-survey-submit-button {\n    background: #FFFFFF;\n    border: 0;\n    font-family: 'Rubik', sans-serif;\n    font-style: normal;\n    font-weight: 300;\n    font-size: 10px;\n    line-height: 12px;\n    padding: 7px 27px;\n    border-radius: 5px;\n    cursor: pointer;\n  }\n  \n  .mtx-survey-submit-button:disabled {\n    opacity: 0.6;\n    cursor: not-allowed;\n  }\n  \n  .mtx-survey--white .mtx-survey-submit-button {\n    background: #292929;\n    color: #fff;\n  }\n  \n  .mtx-survey--black .mtx-survey-submit-button {\n    background: #fff;\n    color: #2f2f2f;\n  }\n</style>\n<h4 class=\"mtx-survey-title\">How would you rate your experience?</h4>\n<div class=\"mtx-survey-items\">\n  <svg width=\"265\" height=\"39\" viewBox=\"0 0 265 39\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g class=\"mtx-survey-item\" data-value=\"1\">\n      <path d=\"M19.2562 37.805C29.2646 37.805 37.3965 29.6731 37.3965 19.6647C37.3965 9.65626 29.2646 1.52441 19.2562 1.52441C9.24777 1.52441 1.11594 9.65626 1.11594 19.6647C1.11594 29.6731 9.24777 37.805 19.2562 37.805Z\" fill=\"#E64355\"/>\n      <path d=\"M19.2564 2.64125C9.87348 2.64125 2.23313 10.2816 2.23313 19.6645C2.23313 29.0474 9.87348 36.6878 19.2564 36.6878C28.6393 36.6878 36.2796 29.0474 36.2796 19.6645C36.2796 10.2816 28.6393 2.64125 19.2564 2.64125ZM19.2564 0.407227C29.8903 0.407227 38.5137 9.03056 38.5137 19.6645C38.5137 30.2985 29.8903 38.9218 19.2564 38.9218C8.62242 38.9218 -0.000896454 30.2985 -0.000896454 19.6645C-0.000896454 9.03056 8.62242 0.407227 19.2564 0.407227Z\" fill=\"#FBD2D8\"/>\n      <path d=\"M23.6645 16.6417C22.7597 16.6417 22.0262 15.5414 22.0262 14.1842C22.0262 12.827 22.7597 11.7268 23.6645 11.7268C24.5693 11.7268 25.3027 12.827 25.3027 14.1842C25.3027 15.5414 24.5693 16.6417 23.6645 16.6417Z\" fill=\"white\"/>\n      <path d=\"M15.1 16.6417C14.1952 16.6417 13.4617 15.5414 13.4617 14.1842C13.4617 12.827 14.1952 11.7268 15.1 11.7268C16.0048 11.7268 16.7383 12.827 16.7383 14.1842C16.7383 15.5414 16.0048 16.6417 15.1 16.6417Z\" fill=\"white\"/>\n      <path d=\"M9.96176 28.2436C9.96176 28.2436 11.7639 21.5713 19.0021 21.5713C25.734 21.5713 28.5488 28.2436 28.5488 28.2436\" stroke=\"white\" stroke-width=\"1.5\" stroke-miterlimit=\"10\" stroke-linecap=\"round\"/>\n    </g>\n   \n    <g class=\"mtx-survey-item\" data-value=\"2\">\n      <path d=\"M75.7699 37.8047C85.7783 37.8047 93.9102 29.6729 93.9102 19.6644C93.9102 9.65602 85.7783 1.52417 75.7699 1.52417C65.7615 1.52417 57.6296 9.65602 57.6296 19.6644C57.6296 29.6729 65.7615 37.8047 75.7699 37.8047Z\" fill=\"#F5A720\"/>\n      <path d=\"M75.7701 2.64125C66.3872 2.64125 58.7468 10.2816 58.7468 19.6645C58.7468 29.0474 66.3872 36.6878 75.7701 36.6878C85.153 36.6878 92.7933 29.0474 92.7933 19.6645C92.7933 10.2816 85.153 2.64125 75.7701 2.64125ZM75.7701 0.407227C86.404 0.407227 95.0273 9.03056 95.0273 19.6645C95.0273 30.2985 86.404 38.9218 75.7701 38.9218C65.1361 38.9218 56.5128 30.2985 56.5128 19.6645C56.5128 9.03056 65.1361 0.407227 75.7701 0.407227Z\" fill=\"#FFE6BE\"/>\n      <path d=\"M80.0609 16.6413C79.1561 16.6413 78.4227 15.5411 78.4227 14.1839C78.4227 12.8267 79.1561 11.7264 80.0609 11.7264C80.9657 11.7264 81.6992 12.8267 81.6992 14.1839C81.6992 15.5411 80.9657 16.6413 80.0609 16.6413Z\" fill=\"white\"/>\n      <path d=\"M71.4848 16.6413C70.58 16.6413 69.8465 15.5411 69.8465 14.1839C69.8465 12.8267 70.58 11.7264 71.4848 11.7264C72.3896 11.7264 73.123 12.8267 73.123 14.1839C73.123 15.5411 72.3896 16.6413 71.4848 16.6413Z\" fill=\"white\"/>\n      <path d=\"M67.7444 27.484C67.7444 27.484 69.4124 23.6266 76.0996 23.6266C81.1038 23.6266 83.8145 27.484 83.8145 27.484\" stroke=\"white\" stroke-width=\"1.5\" stroke-miterlimit=\"10\" stroke-linecap=\"round\"/>\n    </g>\n   \n    <g class=\"mtx-survey-item\" data-value=\"3\">\n      <path d=\"M132.284 37.805C142.292 37.805 150.424 29.6731 150.424 19.6647C150.424 9.65626 142.292 1.52441 132.284 1.52441C122.275 1.52441 114.143 9.65626 114.143 19.6647C114.143 29.6731 122.275 37.805 132.284 37.805Z\" fill=\"#D4C828\"/>\n      <path d=\"M132.284 2.64125C122.901 2.64125 115.26 10.2816 115.26 19.6645C115.26 29.0474 122.901 36.6878 132.284 36.6878C141.667 36.6878 149.307 29.0474 149.307 19.6645C149.307 10.2816 141.667 2.64125 132.284 2.64125ZM132.284 0.407227C142.918 0.407227 151.541 9.03056 151.541 19.6645C151.541 30.2985 142.918 38.9218 132.284 38.9218C121.65 38.9218 113.026 30.2985 113.026 19.6645C113.026 9.03056 121.65 0.407227 132.284 0.407227Z\" fill=\"#F9F297\"/>\n      <path d=\"M136.551 17.49C135.646 17.49 134.913 16.3898 134.913 15.0326C134.913 13.6754 135.646 12.5752 136.551 12.5752C137.456 12.5752 138.189 13.6754 138.189 15.0326C138.189 16.3898 137.456 17.49 136.551 17.49Z\" fill=\"white\"/>\n      <path d=\"M127.989 17.49C127.084 17.49 126.35 16.3898 126.35 15.0326C126.35 13.6754 127.084 12.5752 127.989 12.5752C128.893 12.5752 129.627 13.6754 129.627 15.0326C129.627 16.3898 128.893 17.49 127.989 17.49Z\" fill=\"white\"/>\n      <path d=\"M138.416 25.5475H131.967C126.963 25.5475 126.054 25.5475 126.054 25.5475\" stroke=\"white\" stroke-width=\"1.5\" stroke-miterlimit=\"10\" stroke-linecap=\"round\"/>\n    </g>\n    \n    <g class=\"mtx-survey-item\" data-value=\"4\">\n      <path d=\"M188.797 37.805C198.806 37.805 206.938 29.6731 206.938 19.6647C206.938 9.65626 198.806 1.52441 188.797 1.52441C178.789 1.52441 170.657 9.65626 170.657 19.6647C170.657 29.6731 178.789 37.805 188.797 37.805Z\" fill=\"#A5CE3A\"/>\n      <path d=\"M188.797 2.64125C179.415 2.64125 171.774 10.2816 171.774 19.6645C171.774 29.0474 179.415 36.6878 188.797 36.6878C198.18 36.6878 205.821 29.0474 205.821 19.6645C205.821 10.2816 198.18 2.64125 188.797 2.64125ZM188.797 0.407227C199.431 0.407227 208.055 9.03056 208.055 19.6645C208.055 30.2985 199.431 38.9218 188.797 38.9218C178.163 38.9218 169.54 30.2985 169.54 19.6645C169.54 9.03056 178.163 0.407227 188.797 0.407227Z\" fill=\"#D7E48A\"/>\n      <path d=\"M193.09 17.4898C192.185 17.4898 191.452 16.3896 191.452 15.0324C191.452 13.6752 192.185 12.575 193.09 12.575C193.995 12.575 194.729 13.6752 194.729 15.0324C194.729 16.3896 193.995 17.4898 193.09 17.4898Z\" fill=\"white\"/>\n      <path d=\"M184.512 17.4898C183.607 17.4898 182.874 16.3896 182.874 15.0324C182.874 13.6752 183.607 12.575 184.512 12.575C185.417 12.575 186.15 13.6752 186.15 15.0324C186.15 16.3896 185.417 17.4898 184.512 17.4898Z\" fill=\"white\"/>\n      <path d=\"M196.828 24.4751C196.828 24.4751 195.16 28.3325 188.473 28.3325C183.469 28.3325 180.758 24.4751 180.758 24.4751\" stroke=\"white\" stroke-width=\"1.5\" stroke-miterlimit=\"10\" stroke-linecap=\"round\"/>\n    </g>\n    \n    <g class=\"mtx-survey-item\" data-value=\"5\">\n      <path d=\"M245.311 37.8048C255.319 37.8048 263.451 29.673 263.451 19.6646C263.451 9.65614 255.319 1.52429 245.311 1.52429C235.302 1.52429 227.171 9.65614 227.171 19.6646C227.171 29.673 235.302 37.8048 245.311 37.8048Z\" fill=\"#84C441\"/>\n      <path d=\"M245.311 2.64101C235.928 2.64101 228.288 10.2814 228.288 19.6643C228.288 29.0472 235.928 36.6875 245.311 36.6875C254.694 36.6875 262.334 29.0472 262.334 19.6643C262.334 10.2814 254.694 2.64101 245.311 2.64101ZM245.311 0.406982C255.945 0.406982 264.568 9.03031 264.568 19.6643C264.568 30.2982 255.945 38.9216 245.311 38.9216C234.677 38.9216 226.054 30.2982 226.054 19.6643C226.054 9.03031 234.677 0.406982 245.311 0.406982Z\" fill=\"#C9DF86\"/>\n      <path d=\"M249.717 17.4898C248.812 17.4898 248.079 16.3896 248.079 15.0324C248.079 13.6752 248.812 12.575 249.717 12.575C250.622 12.575 251.355 13.6752 251.355 15.0324C251.355 16.3896 250.622 17.4898 249.717 17.4898Z\" fill=\"white\"/>\n      <path d=\"M241.153 17.4898C240.248 17.4898 239.514 16.3896 239.514 15.0324C239.514 13.6752 240.248 12.575 241.153 12.575C242.058 12.575 242.791 13.6752 242.791 15.0324C242.791 16.3896 242.058 17.4898 241.153 17.4898Z\" fill=\"white\"/>\n      <path d=\"M254.602 22.4196C254.602 22.4196 252.799 29.0918 245.561 29.0918C238.829 29.0918 236.014 22.4196 236.014 22.4196\" stroke=\"white\" stroke-width=\"1.5\" stroke-miterlimit=\"10\" stroke-linecap=\"round\"/>\n    </g>\n  </svg>\n</div>\n<div class=\"mtx-survey-submit-holder\">\n  <button type=\"button\" class=\"mtx-survey-submit-button\" disabled>Submit</button>\n</div>`;\n\nconst SURVEY_SUCCESSFULLY_LOGGED = 'mtx-survey-successfully-logged';\n\nconst getSurveyLogs = () => {\n  const result = localStorage.getItem(SURVEY_SUCCESSFULLY_LOGGED);\n\n  if (result === null) {\n    return {};\n  }\n\n  return JSON.parse(result);\n};\n\nconst getIsSurveyLogged = (appkey: string) => {\n  const logs = getSurveyLogs();\n\n  return logs[appkey] !== undefined;\n};\n\nconst setSurveyLogged = (appkey: string, rating: number) => {\n  const logs = getSurveyLogs();\n\n  logs[appkey] = rating;\n\n  return localStorage.setItem(SURVEY_SUCCESSFULLY_LOGGED, JSON.stringify(logs));\n};\n\nlet surveyHolder = document.createElement('div');\n\nconst hideSurvey = (holder: ReturnType<Document['createElement']>) => {\n  holder.classList.add('mtx-survey--close');\n  setTimeout(() => document.body.contains(holder) && document.body.removeChild(holder), 350);\n};\n\nexport const addSurvey = ({ appkey, sessionId, force = false, theme = 'white' }: AddSurveyProps) => {\n  hideSurvey(surveyHolder);\n  const isLogged = getIsSurveyLogged(appkey);\n\n  /** Don't show the survey twice in automatic mode */\n  if (isLogged && !force) {\n    return;\n  }\n\n  surveyHolder = document.createElement('div');\n  surveyHolder.setAttribute('class', `mtx-survey mtx-survey--${theme}`);\n  surveyHolder.innerHTML = template;\n  let rating: number | null = null;\n\n  document.body.appendChild(surveyHolder);\n\n  setTimeout(() => surveyHolder.classList.add('mtx-survey--open'), 0);\n\n  const items = [...surveyHolder.querySelectorAll('.mtx-survey-item')];\n  const submitButton = surveyHolder.querySelector('.mtx-survey-submit-button');\n\n  const setActiveItem = (item: Element) => {\n    items.forEach(itemScore => {\n      if (item !== itemScore) {\n        itemScore.setAttribute('style', 'opacity: 0.6');\n      } else {\n        itemScore.setAttribute('style', 'opacity: 1');\n      }\n    });\n  };\n\n  const handleItemClick = (item: Element) => {\n    item.addEventListener('click', () => {\n      rating = Number(item.getAttribute('data-value'));\n      submitButton?.removeAttribute('disabled');\n      setActiveItem(item);\n    });\n  };\n\n  items.forEach(handleItemClick);\n\n  submitButton?.addEventListener('click', async () => {\n    if (rating === null) {\n      return;\n    }\n\n    hideSurvey(surveyHolder);\n\n    try {\n      await sendMetricSurveysData({\n        appkey,\n        sessionId,\n        rating,\n      });\n\n      setSurveyLogged(appkey, rating);\n    } catch (e) {\n      console.log(e);\n    }\n  });\n};\n","const _lut = [];\n\nfor ( let i = 0; i < 256; i ++ ) {\n\n\t_lut[ i ] = ( i < 16 ? '0' : '' ) + ( i ).toString( 16 );\n\n}\n\nlet _seed = 1234567;\n\n\nconst DEG2RAD = Math.PI / 180;\nconst RAD2DEG = 180 / Math.PI;\n\n// http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136\nfunction generateUUID() {\n\n\tconst d0 = Math.random() * 0xffffffff | 0;\n\tconst d1 = Math.random() * 0xffffffff | 0;\n\tconst d2 = Math.random() * 0xffffffff | 0;\n\tconst d3 = Math.random() * 0xffffffff | 0;\n\tconst uuid = _lut[ d0 & 0xff ] + _lut[ d0 >> 8 & 0xff ] + _lut[ d0 >> 16 & 0xff ] + _lut[ d0 >> 24 & 0xff ] + '-' +\n\t\t\t_lut[ d1 & 0xff ] + _lut[ d1 >> 8 & 0xff ] + '-' + _lut[ d1 >> 16 & 0x0f | 0x40 ] + _lut[ d1 >> 24 & 0xff ] + '-' +\n\t\t\t_lut[ d2 & 0x3f | 0x80 ] + _lut[ d2 >> 8 & 0xff ] + '-' + _lut[ d2 >> 16 & 0xff ] + _lut[ d2 >> 24 & 0xff ] +\n\t\t\t_lut[ d3 & 0xff ] + _lut[ d3 >> 8 & 0xff ] + _lut[ d3 >> 16 & 0xff ] + _lut[ d3 >> 24 & 0xff ];\n\n\t// .toUpperCase() here flattens concatenated strings to save heap memory space.\n\treturn uuid.toUpperCase();\n\n}\n\nfunction clamp( value, min, max ) {\n\n\treturn Math.max( min, Math.min( max, value ) );\n\n}\n\n// compute euclidian modulo of m % n\n// https://en.wikipedia.org/wiki/Modulo_operation\nfunction euclideanModulo( n, m ) {\n\n\treturn ( ( n % m ) + m ) % m;\n\n}\n\n// Linear mapping from range <a1, a2> to range <b1, b2>\nfunction mapLinear( x, a1, a2, b1, b2 ) {\n\n\treturn b1 + ( x - a1 ) * ( b2 - b1 ) / ( a2 - a1 );\n\n}\n\n// https://www.gamedev.net/tutorials/programming/general-and-gameplay-programming/inverse-lerp-a-super-useful-yet-often-overlooked-function-r5230/\nfunction inverseLerp( x, y, value ) {\n\n\tif ( x !== y ) {\n\n\t\treturn ( value - x ) / ( y - x );\n\n\t} else {\n\n\t\treturn 0;\n\n\t}\n\n}\n\n// https://en.wikipedia.org/wiki/Linear_interpolation\nfunction lerp( x, y, t ) {\n\n\treturn ( 1 - t ) * x + t * y;\n\n}\n\n// http://www.rorydriscoll.com/2016/03/07/frame-rate-independent-damping-using-lerp/\nfunction damp( x, y, lambda, dt ) {\n\n\treturn lerp( x, y, 1 - Math.exp( - lambda * dt ) );\n\n}\n\n// https://www.desmos.com/calculator/vcsjnyz7x4\nfunction pingpong( x, length = 1 ) {\n\n\treturn length - Math.abs( euclideanModulo( x, length * 2 ) - length );\n\n}\n\n// http://en.wikipedia.org/wiki/Smoothstep\nfunction smoothstep( x, min, max ) {\n\n\tif ( x <= min ) return 0;\n\tif ( x >= max ) return 1;\n\n\tx = ( x - min ) / ( max - min );\n\n\treturn x * x * ( 3 - 2 * x );\n\n}\n\nfunction smootherstep( x, min, max ) {\n\n\tif ( x <= min ) return 0;\n\tif ( x >= max ) return 1;\n\n\tx = ( x - min ) / ( max - min );\n\n\treturn x * x * x * ( x * ( x * 6 - 15 ) + 10 );\n\n}\n\n// Random integer from <low, high> interval\nfunction randInt( low, high ) {\n\n\treturn low + Math.floor( Math.random() * ( high - low + 1 ) );\n\n}\n\n// Random float from <low, high> interval\nfunction randFloat( low, high ) {\n\n\treturn low + Math.random() * ( high - low );\n\n}\n\n// Random float from <-range/2, range/2> interval\nfunction randFloatSpread( range ) {\n\n\treturn range * ( 0.5 - Math.random() );\n\n}\n\n// Deterministic pseudo-random float in the interval [ 0, 1 ]\nfunction seededRandom( s ) {\n\n\tif ( s !== undefined ) _seed = s % 2147483647;\n\n\t// Park-Miller algorithm\n\n\t_seed = _seed * 16807 % 2147483647;\n\n\treturn ( _seed - 1 ) / 2147483646;\n\n}\n\nfunction degToRad( degrees ) {\n\n\treturn degrees * DEG2RAD;\n\n}\n\nfunction radToDeg( radians ) {\n\n\treturn radians * RAD2DEG;\n\n}\n\nfunction isPowerOfTwo( value ) {\n\n\treturn ( value & ( value - 1 ) ) === 0 && value !== 0;\n\n}\n\nfunction ceilPowerOfTwo( value ) {\n\n\treturn Math.pow( 2, Math.ceil( Math.log( value ) / Math.LN2 ) );\n\n}\n\nfunction floorPowerOfTwo( value ) {\n\n\treturn Math.pow( 2, Math.floor( Math.log( value ) / Math.LN2 ) );\n\n}\n\nfunction setQuaternionFromProperEuler( q, a, b, c, order ) {\n\n\t// Intrinsic Proper Euler Angles - see https://en.wikipedia.org/wiki/Euler_angles\n\n\t// rotations are applied to the axes in the order specified by 'order'\n\t// rotation by angle 'a' is applied first, then by angle 'b', then by angle 'c'\n\t// angles are in radians\n\n\tconst cos = Math.cos;\n\tconst sin = Math.sin;\n\n\tconst c2 = cos( b / 2 );\n\tconst s2 = sin( b / 2 );\n\n\tconst c13 = cos( ( a + c ) / 2 );\n\tconst s13 = sin( ( a + c ) / 2 );\n\n\tconst c1_3 = cos( ( a - c ) / 2 );\n\tconst s1_3 = sin( ( a - c ) / 2 );\n\n\tconst c3_1 = cos( ( c - a ) / 2 );\n\tconst s3_1 = sin( ( c - a ) / 2 );\n\n\tswitch ( order ) {\n\n\t\tcase 'XYX':\n\t\t\tq.set( c2 * s13, s2 * c1_3, s2 * s1_3, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'YZY':\n\t\t\tq.set( s2 * s1_3, c2 * s13, s2 * c1_3, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'ZXZ':\n\t\t\tq.set( s2 * c1_3, s2 * s1_3, c2 * s13, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'XZX':\n\t\t\tq.set( c2 * s13, s2 * s3_1, s2 * c3_1, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'YXY':\n\t\t\tq.set( s2 * c3_1, c2 * s13, s2 * s3_1, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'ZYZ':\n\t\t\tq.set( s2 * s3_1, s2 * c3_1, c2 * s13, c2 * c13 );\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tconsole.warn( 'THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: ' + order );\n\n\t}\n\n}\n\n\n\n\nexport {\n\tDEG2RAD,\n\tRAD2DEG,\n\tgenerateUUID,\n\tclamp,\n\teuclideanModulo,\n\tmapLinear,\n\tinverseLerp,\n\tlerp,\n\tdamp,\n\tpingpong,\n\tsmoothstep,\n\tsmootherstep,\n\trandInt,\n\trandFloat,\n\trandFloatSpread,\n\tseededRandom,\n\tdegToRad,\n\tradToDeg,\n\tisPowerOfTwo,\n\tceilPowerOfTwo,\n\tfloorPowerOfTwo,\n\tsetQuaternionFromProperEuler,\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","import { Scene, Vector3 } from 'babylonjs';\nimport { MetalitixLoggerOptions } from '../types';\nimport MetalitixLoggerBase from './mtx-poll-base';\n\nexport default class MetalitixLogger extends MetalitixLoggerBase<Scene> {\n  constructor(appKey: string, options: MetalitixLoggerOptions = {}) {\n    super(appKey, options);\n  }\n\n  protected getPositionData = (scene: Scene | null) => {\n    const camera = scene?.activeCamera ?? null;\n    if (camera === null) {\n      return undefined;\n    }\n\n    const euler = camera.absoluteRotation.toEulerAngles().normalize();\n\n    return {\n      position: { x: camera.position.x, y: camera.position.y, z: camera.position.z },\n      direction: { x: euler.x, y: euler.y * -1, z: euler.z },\n    };\n  };\n\n  protected getCameraData = (scene: Scene | null) => {\n    const camera = scene?.activeCamera ?? null;\n    if (camera === null) {\n      return undefined;\n    }\n\n    return {\n      fieldOfView: camera.fov,\n      aspectRatio: camera.viewport.width / camera.viewport.height,\n      zNearPlane: camera.minZ,\n      zFarPlane: camera.maxZ,\n    };\n  };\n}\n"],"names":["root","factory","exports","module","define","amd","self","MetalitixLoggerBase","constructor","appKey","options","interval","DEFAULT_INTERVAL_VALUE","customData","object3D","setPollInterval","pollInterval","this","Math","min","MAX_INTERVAL_VALUE","max","MIN_INTERVAL_VALUE","updateFPS","frames","time","Date","now","prevFPSTime","currentFPS","loopFPS","loopFPSRequestId","requestAnimationFrame","stopFPSLoop","cancelAnimationFrame","setCustomField","key","value","removeCustomField","getRecord","eventType","sessionId","userEvent","userMeta","camera","data","resultData","Object","assign","base","object","appkey","apiver","apiVersion","timestamp","metrics","fps","round","XRAnalytics","console","assert","undefined","Error","addRecord","record","pollRecords","push","sendPosition","sendAll","pollInProgress","items","slice","MAXIMUM_BATCH_RECORDS_LENGTH","batchRecordsData","sendXRAnalyticsData","length","lastPollTimestamp","error","log","forceStopLoop","getUserMeta","userAgent","window","navigator","pagePath","location","pathname","pageQuery","search","systemInfo","deviceName","deviceType","operatingSystemName","family","operatingSystemVersion","version","addSessionStart","getPositionData","getCameraData","previousCameraData","addSessionEnd","deepEqual","addUserPosition","addSessionUpdate","sddNextUserPositionAndUpdateCameraIfNeeded","sendPositionLoop","start","MAXIMUM_BATCH_SENDING_INTERVAL","nextPoll","setTimeout","clearTimeout","clearSessionPollRecords","handleVisibilityChange","document","visibilityState","pauseSession","resumeSession","startSession","generateUUID","addEventListener","showSurveyAutomatically","surveyTimer","addSurvey","theme","surveyTheme","autoSurveyShowInMs","MAXIMUM_SESSION_KEEPALIVE_TIME","endSession","removeEventListener","updateUserMeta","sendUserEvent","eventName","target","points","params","logCustomEvent","logKeyDownEvent","x","y","state","position","logKeyPressEvent","logKeyUpEvent","logMouseEnterEvent","logMouseLeaveEvent","logMouseOverEvent","logMouseOutEvent","logMouseDownEvent","logMouseUpEvent","logMouseMoveEvent","logMousePressEvent","logTouchTapEvent","logTouchStartEvent","logTouchMoveEvent","logTouchEndEvent","logZoomStartEvent","logZoomUpdateEvent","logZoomEndEvent","showSurvey","force","random","objectTypes","freeExports","freeModule","nodeType","freeGlobal","g","global","maxSafeInteger","pow","reOpera","objectProto","prototype","hasOwnProperty","toString","capitalize","string","String","charAt","toUpperCase","format","trim","test","forOwn","callback","call","getClassOf","qualify","replace","reduce","array","accumulator","index","each","platform","parse","ua","context","isCustomContext","nav","isSpecialCasedOS","type","likeChrome","objectClass","airRuntimeClass","enviroClass","javaClass","java","phantomClass","rhino","environment","alpha","beta","doc","opera","operamini","operaClass","arch","description","prerelease","useFeatures","layout","result","guess","RegExp","pattern","exec","label","name","product","getProduct","manufacturer","os","split","cleanupOS","guesses","getVersion","patterns","unshift","indexOf","parseFloat","runtime","flash","system","Capabilities","phantom","major","minor","patch","documentMode","toFixed","lang","System","getProperty","require","join","e","process","browser","versions","electron","node","nw","appMinorVersion","external","parseInt","architecture","cpuClass","fetch","API_URL","method","keepalive","headers","body","JSON","stringify","sendMetricSurveysData","API_ORIGIN","isProduction","isStaging","API_VERSION","PointStates","UserInteractionTypes","EventTypes","KnownPointStates","values","KnownUserInteractionTypes","KnownEventTypes","ok","keys","tx","every","isObject","item","Array","isArray","mergeDeep","source","output","forEach","isTablet","isMobile","SURVEY_SUCCESSFULLY_LOGGED","getSurveyLogs","localStorage","getItem","surveyHolder","createElement","hideSurvey","holder","classList","add","contains","removeChild","isLogged","getIsSurveyLogged","setAttribute","innerHTML","rating","appendChild","querySelectorAll","submitButton","querySelector","Number","getAttribute","removeAttribute","itemScore","setActiveItem","logs","setItem","setSurveyLogged","_lut","i","_seed","DEG2RAD","PI","RAD2DEG","d0","d1","d2","d3","clamp","euclideanModulo","n","m","mapLinear","a1","a2","b1","b2","inverseLerp","lerp","t","damp","lambda","dt","exp","pingpong","abs","smoothstep","smootherstep","randInt","low","high","floor","randFloat","randFloatSpread","range","seededRandom","s","degToRad","degrees","radToDeg","radians","isPowerOfTwo","ceilPowerOfTwo","ceil","LN2","floorPowerOfTwo","setQuaternionFromProperEuler","q","a","b","c","order","cos","sin","c2","s2","c13","s13","c1_3","s1_3","c3_1","s3_1","set","warn","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","id","loaded","__webpack_modules__","getter","__esModule","d","definition","o","defineProperty","enumerable","get","globalThis","Function","obj","prop","r","Symbol","toStringTag","nmd","paths","children","MetalitixLogger","super","scene","activeCamera","euler","absoluteRotation","toEulerAngles","normalize","z","direction","fieldOfView","fov","aspectRatio","viewport","width","height","zNearPlane","minZ","zFarPlane","maxZ"],"sourceRoot":""}